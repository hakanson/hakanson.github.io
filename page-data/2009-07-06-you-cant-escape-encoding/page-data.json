{"componentChunkName":"component---src-templates-blog-post-js","path":"/2009-07-06-you-cant-escape-encoding","result":{"data":{"site":{"siteMetadata":{"title":"kevinhakanson.com","author":"Kevin Hakanson"}},"markdownRemark":{"id":"2df0972c-4f3f-5dfb-8eed-365513fde6fa","excerpt":"Recently I have run across several items where the solution to the problem was a proper understanding of encoding and escaping.  One issue was with the…","html":"<p>Recently I have run across several items where the solution to the problem was a proper understanding of encoding and escaping.  One issue was with the <a href=\"http://developer.yahoo.com/yui/compressor/\">YUICompressor</a> having problems with some of our JavaScript files.  The core issue was that it couldn’t handle files saved in UTF-8 with the Byte Order Mark (which is the Visual Studio 2008 default).  Lucky for someone, I was able to answer a <a href=\"http://stackoverflow.com/questions/1036201/errors-using-yuicompressor/1047143#1047143\">Stack Overflow question</a> with my new found knowledge.</p>\n<p>A short while later, I saw a bug where the subject line of delivery emails looked like:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">\\=?ANSI\\_X3.4-1968?Q?=3F=3F\\_1.\\_Title\\_and\\_Divisions\\_of\\_Code?= </code></pre></div>\n<p>I referred the developer to the three parameter version of the <code class=\"language-text\">encodeText</code> function of Java’s <a href=\"http://java.sun.com/j2ee/sdk_1.3/techdocs/api/javax/mail/internet/MimeUtility.html\">MimeUtility</a>.  This has a “set of methods to encode and decode MIME headers as per <a href=\"http://www.ietf.org/rfc/rfc2047.txt\">RFC 2047</a>”.  In this case, by using the one parameter version, the code was subject to some OS specific setting which worked on the developer’s computer running Windows but not when deployed to Linux.</p>\n<p>To help my fellow developers, here’s a link to <a href=\"http://www.joelonsoftware.com/articles/Unicode.html\">The Absolute Minimum Every Software Developer Absolutely, Positively Must Know About Unicode and Character Sets (No Excuses!)</a> by Joel Spolsky.  He does a great job of walking through the subject.  Also, I recently found this nifty link to an online <a href=\"http://0xcc.net/jsescape/\">Text Escaping and Unescaping in JavaScript</a> utility.  Try pasting <code class=\"language-text\">¶§</code> into the plain text field and look at the results.  The “MIME + Quoted-printable” section is the same as Encoded Word from RFC 2047.</p>\n<p>For me, to fully understand UTF-8 encoding, I had to walk myself through an example, which I include here:</p>\n<p>When a Unicode (ISO 10646) character in the range of 0x80 - 0x799 is encoded using UTF-8, it takes up 2 bytes of space. Since printable ISO-8859-1 characters (aka Latin 1 or upper ASCII) are in the range of 0xA0 - 0xFF - they fall into this category.</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">BYTE 1 = 1100 0000 | (0001 1111 &amp; b)  \r\nBTYE 2 = 1000 0000 | (0011 1111 &amp; b)</code></pre></div>\n<p>So for a character like <code class=\"language-text\">é</code> (Latin Small Letter E with Acute)</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">é = 233 = 0xE9 = 1110 1011</code></pre></div>\n<p>when it’s UTF-8 encoded</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">1100 0011 1010 1001 = 0xC3 0xA9 = Ã©</code></pre></div>\n<p>Notice that when encoding ISO-8859-1 with UTF-8 and you happen to view the output as ISO-8859-1, the first character of the two is always a capital A with some variation. The following table can help describe why.</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">range byte 1 display char  \r\n0x80 - 0x9F (128-159) 0xC0 À  \r\n0xA0 - 0xBF (160-191) 0xC1 Á  \r\n0xC0 - 0xDF (192-223) 0xC2 Â  \r\n0xE0 - 0xFF (224-255) 0xC3 Ã</code></pre></div>\n<p>Another “odd” situation exists when the <code class=\"language-text\">Copyright Sign</code> or <code class=\"language-text\">Pound Sign</code> value from unicode…</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">© = 169 = 0xA9 = 1010 1001  \r\n£ = 163 = 0xA3 = 1010 0011</code></pre></div>\n<p>…is UTF-8 encoded, and become the <code class=\"language-text\">Â</code> character followed by themselves.</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">1100 0010 1010 1001 = 0xC3 0xA9 = Â©  \r\n1100 0010 1010 0011 = 0XC3 0xA3 = Â£</code></pre></div>","frontmatter":{"title":"You can’t escape encoding","description":null,"date":"July 6, 2009","tags":["webdev"],"canonical":null}}},"pageContext":{"slug":"/2009-07-06-you-cant-escape-encoding","previous":{"fields":{"slug":"/2009-05-20-my-first-jquery-ticket"},"frontmatter":{"tags":["javascript","jquery","opensource"]}},"next":{"fields":{"slug":"/2009-08-03-javascript-vs-json-encoding"},"frontmatter":{"tags":["javascript"]}}}},"staticQueryHashes":["2589769190","97908498"],"slicesMap":{}}