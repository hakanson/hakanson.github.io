{"componentChunkName":"component---src-templates-blog-post-js","path":"/2016-07-20-zipkin-js-investigation-part-2","result":{"data":{"site":{"siteMetadata":{"title":"kevinhakanson.com","author":"Kevin Hakanson"}},"markdownRemark":{"id":"6149d67e-f684-5a00-aaa5-5a67a4909e2a","excerpt":"The continuing story from my Zipkin JS Investigation My zipkin-js issue was fixed a couple days ago when zipkin-js/packages/zipkin-transport-http landed, so I…","html":"<p>The continuing story from my <a href=\"../2016-06-10-zipkin-js-investigation\">Zipkin JS Investigation</a></p>\n<p>My zipkin-js <a href=\"https://github.com/openzipkin/zipkin-js/issues/15\">issue</a> was fixed a couple days ago when <a href=\"https://github.com/openzipkin/zipkin-js/tree/master/packages/zipkin-transport-http\">zipkin-js/packages/zipkin-transport-http</a> landed, so I decided to revisit my test project and see how it works.</p>\n<p>I updated my <code class=\"language-text\">app.js</code> to use <code class=\"language-text\">BatchRecorder</code> and <code class=\"language-text\">HttpLogger</code>.</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span>Tracer<span class=\"token punctuation\">,</span> ExplicitContext<span class=\"token punctuation\">,</span> BatchRecorder<span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'zipkin'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  \r\n<span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span>HttpLogger<span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'zipkin-transport-http'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  \r\n  \r\n<span class=\"token keyword\">const</span> ctxImpl <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">ExplicitContext</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  \r\n<span class=\"token keyword\">const</span> recorder <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">BatchRecorder</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>  \r\n  <span class=\"token literal-property property\">logger</span><span class=\"token operator\">:</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">HttpLogger</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>  \r\n    <span class=\"token literal-property property\">endpoint</span><span class=\"token operator\">:</span> <span class=\"token string\">'http://localhost:9411/api/v1/spans'</span>  \r\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>  \r\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  \r\n<span class=\"token keyword\">const</span> tracer <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Tracer</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>ctxImpl<span class=\"token punctuation\">,</span> recorder<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  </code></pre></div>\n<p>Then using instructions from <a href=\"http://zipkin.io/pages/quickstart.html\">Quickstart · OpenZipkin</a>, I ran a docker command to get started, …</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">$ <span class=\"token function\">docker</span> run <span class=\"token parameter variable\">-d</span> <span class=\"token parameter variable\">-p</span> <span class=\"token number\">9411</span>:9411 openzipkin/zipkin</code></pre></div>\n<p>… ran my recursive service code, …</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 343px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/97a0de583cde0bb7d4a2f0bbb764e199/41431/pastedImage_24.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 18.91891891891892%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAECAYAAACOXx+WAAAACXBIWXMAAAsTAAALEwEAmpwYAAAA4UlEQVQY0z2P24rCQBBE8/9fpjFqlmQ2l7nuJJlEJSIoKlnhLI6wD001RdcpOlFKIaWMk2UZ3necTke89zRNg5QKrTXOOYyx0R9CYBgGxjFwuVy43W5cr9eoiRCCoigQomS9XkfgPM84a9nv9pSloG3bCNLGEELAdx1d5xn6nvv9wev1YlkWno8HidbvowGlNGMY/5vfXuc9h+MRax193zNNE4dpilBr7EetxRiD9z/M5zPJapVijaESgjz/wlmH1p83N2lKIyV1XbPb7mJQSYmSimyzpaq+Mc6xz/O4L8svfxTLIgGv43bbAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"browser screenshot\"\n        title=\"browser screenshot\"\n        src=\"/static/97a0de583cde0bb7d4a2f0bbb764e199/41431/pastedImage_24.png\"\n        srcset=\"/static/97a0de583cde0bb7d4a2f0bbb764e199/12f09/pastedImage_24.png 148w,\n/static/97a0de583cde0bb7d4a2f0bbb764e199/e4a3f/pastedImage_24.png 295w,\n/static/97a0de583cde0bb7d4a2f0bbb764e199/41431/pastedImage_24.png 343w\"\n        sizes=\"(max-width: 343px) 100vw, 343px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<p>… and looked in zipkin to see the result:</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/0c58787a957cd5b96305f3f20441aec8/66caf/pastedImage_0.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 12.837837837837837%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAADCAYAAACTWi8uAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAwUlEQVQI1y2JS07DMAAFc5MekQtwhK64ASeAbaXuWSCxoES0lkIkSoMT50Psxokdx4OIGOlp9DTJPq95PEky1aO1wdiJ0QVkVWMnz7xAqRpU+8MCOB+om47BTuvvtaGqW1yIGDuSbO72JLcP3L/k4B1pXnD8LDm3A0Xv+OrG1d/aI6QmvXSI6oqoBo7SkCm79s56fIgk26eMm90br6XmDzcHJufwcyAscd0cFmIEUTQ8iwuHc8u7NKSF5kNd/3sEIr+iSN+XwKyzIwAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Zipkin trace\"\n        title=\"Zipkin trace\"\n        src=\"/static/0c58787a957cd5b96305f3f20441aec8/fcda8/pastedImage_0.png\"\n        srcset=\"/static/0c58787a957cd5b96305f3f20441aec8/12f09/pastedImage_0.png 148w,\n/static/0c58787a957cd5b96305f3f20441aec8/e4a3f/pastedImage_0.png 295w,\n/static/0c58787a957cd5b96305f3f20441aec8/fcda8/pastedImage_0.png 590w,\n/static/0c58787a957cd5b96305f3f20441aec8/66caf/pastedImage_0.png 853w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>","frontmatter":{"title":"Zipkin JS Investigation (Part 2)","description":null,"date":"July 20, 2016","tags":["javascript","api","monitoring"],"canonical":null}}},"pageContext":{"slug":"/2016-07-20-zipkin-js-investigation-part-2","previous":{"fields":{"slug":"/2016-07-11-pokemon-go-vs-certificate-pinning"},"frontmatter":{"tags":["http","security","pokemon"]}},"next":{"fields":{"slug":"/2016-07-20-categorizing-information-security-topics"},"frontmatter":{"tags":["security"]}}}},"staticQueryHashes":["2589769190","97908498"]}