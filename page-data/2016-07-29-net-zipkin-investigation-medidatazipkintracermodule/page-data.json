{"componentChunkName":"component---src-templates-blog-post-js","path":"/2016-07-29-net-zipkin-investigation-medidatazipkintracermodule","result":{"data":{"site":{"siteMetadata":{"title":"kevinhakanson.com","author":"Kevin Hakanson"}},"markdownRemark":{"id":"27ce5712-45cd-5474-add7-8fe1213c3e7b","excerpt":"Medidata.ZipkinTracerModule is a “A .NET implementation of the Zipkin Tracer client.”  I built a simple Web Api 2 service, similar to the code from the Zipkin…","html":"<p><a href=\"https://github.com/mdsol/Medidata.ZipkinTracerModule\">Medidata.ZipkinTracerModule</a> is a “A .NET implementation of the Zipkin Tracer client.”  I built a simple Web Api 2 service, similar to the code from the <a href=\"../2016-06-10-zipkin-js-investigation\">Zipkin JS Investigation</a>.  The service recursively calls itself base on the count parameter:  (e.g., <code class=\"language-text\">http://localhost:52399/api/hello?count=3</code>).</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">Hello World! (x3)\nHello World! (x2)\nHello World!</code></pre></div>\n<p><code class=\"language-text\">ZipkinTracerModule</code> is implemented as a OWIN Middleware and required an <code class=\"language-text\">OwinStartup</code> class to configure <code class=\"language-text\">Zipkin</code>.</p>\n<div class=\"gatsby-highlight\" data-language=\"csharp\"><pre class=\"language-csharp\"><code class=\"language-csharp\"><span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">OwinStartup</span>  \n<span class=\"token punctuation\">{</span>  \n    <span class=\"token keyword\">public</span> <span class=\"token keyword\">static</span> <span class=\"token class-name\">ZipkinConfig</span> _zipkinConfig<span class=\"token punctuation\">;</span>  \n    <span class=\"token keyword\">public</span> <span class=\"token return-type class-name\"><span class=\"token keyword\">void</span></span> <span class=\"token function\">Configuration</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">IAppBuilder</span> app<span class=\"token punctuation\">)</span>  \n    <span class=\"token punctuation\">{</span>  \n        <span class=\"token class-name\"><span class=\"token keyword\">var</span></span> zipkinConfig <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token constructor-invocation class-name\">ZipkinConfig</span>  \n        <span class=\"token punctuation\">{</span>  \n            Domain <span class=\"token operator\">=</span> request <span class=\"token operator\">=></span> <span class=\"token keyword\">new</span> <span class=\"token constructor-invocation class-name\">Uri</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"http://localhost\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>  \n            ZipkinBaseUri <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token constructor-invocation class-name\">Uri</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"http://10.194.52.207:9411\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>  \n            SpanProcessorBatchSize <span class=\"token operator\">=</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span>  \n            SampleRate <span class=\"token operator\">=</span> <span class=\"token number\">1</span>  \n        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>  \n        <span class=\"token comment\">// TODO: how can I register this with Unity and inject into Controller?  </span>\n        _zipkinConfig <span class=\"token operator\">=</span> zipkinConfig<span class=\"token punctuation\">;</span>  \n        app<span class=\"token punctuation\">.</span><span class=\"token function\">UseZipkin</span><span class=\"token punctuation\">(</span>zipkinConfig<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  \n    <span class=\"token punctuation\">}</span>  \n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>The <code class=\"language-text\">HelloController</code> uses the <code class=\"language-text\">ZipkinConfig</code> and the <code class=\"language-text\">OwinContext</code> to configure a <code class=\"language-text\">ZipkinClient</code> which plugs into the .NET provided <code class=\"language-text\">HttpClient</code>.  This is what propagates the trace, parent, and span ID values.</p>\n<div class=\"gatsby-highlight\" data-language=\"csharp\"><pre class=\"language-csharp\"><code class=\"language-csharp\"><span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">HelloController</span> <span class=\"token punctuation\">:</span> <span class=\"token type-list\"><span class=\"token class-name\">ApiController</span></span>  \n<span class=\"token punctuation\">{</span>  \n    <span class=\"token keyword\">private</span> <span class=\"token class-name\">IZipkinConfig</span> _zipkinConfig <span class=\"token operator\">=</span> OwinStartup<span class=\"token punctuation\">.</span>_zipkinConfig<span class=\"token punctuation\">;</span>  \n    <span class=\"token comment\">// TODO: how can I inject _zipkinConfig using Unity?  </span>\n\n    <span class=\"token keyword\">public</span> <span class=\"token keyword\">async</span> <span class=\"token return-type class-name\">System<span class=\"token punctuation\">.</span>Threading<span class=\"token punctuation\">.</span>Tasks<span class=\"token punctuation\">.</span>Task<span class=\"token punctuation\">&lt;</span>HttpResponseMessage<span class=\"token punctuation\">></span></span> <span class=\"token function\">Get</span><span class=\"token punctuation\">(</span><span class=\"token class-name\"><span class=\"token keyword\">int</span></span> count <span class=\"token operator\">=</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span>  \n    <span class=\"token punctuation\">{</span>  \n        <span class=\"token class-name\"><span class=\"token keyword\">string</span></span> msg <span class=\"token operator\">=</span> <span class=\"token string\">\"Hello World!\\n\"</span><span class=\"token punctuation\">;</span>  \n        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>count <span class=\"token operator\">></span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span>  \n        <span class=\"token punctuation\">{</span>  \n            <span class=\"token class-name\"><span class=\"token keyword\">var</span></span> context <span class=\"token operator\">=</span> System<span class=\"token punctuation\">.</span>Web<span class=\"token punctuation\">.</span>HttpContext<span class=\"token punctuation\">.</span>Current<span class=\"token punctuation\">.</span><span class=\"token function\">GetOwinContext</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  \n            <span class=\"token class-name\"><span class=\"token keyword\">var</span></span> client <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token constructor-invocation class-name\">ZipkinClient</span><span class=\"token punctuation\">(</span>_zipkinConfig<span class=\"token punctuation\">,</span> context<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  \n\n            <span class=\"token keyword\">using</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\"><span class=\"token keyword\">var</span></span> httpClient <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token constructor-invocation class-name\">HttpClient</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">new</span> <span class=\"token constructor-invocation class-name\">ZipkinMessageHandler</span><span class=\"token punctuation\">(</span>client<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>  \n            <span class=\"token punctuation\">{</span>  \n                httpClient<span class=\"token punctuation\">.</span>BaseAddress <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token constructor-invocation class-name\">Uri</span><span class=\"token punctuation\">(</span>Request<span class=\"token punctuation\">.</span>RequestUri<span class=\"token punctuation\">,</span> RequestContext<span class=\"token punctuation\">.</span>VirtualPathRoot<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  \n                <span class=\"token class-name\">HttpResponseMessage</span> httpClientResponse <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> httpClient<span class=\"token punctuation\">.</span><span class=\"token function\">GetAsync</span><span class=\"token punctuation\">(</span><span class=\"token interpolation-string\"><span class=\"token string\">$\"api/hello?count=</span><span class=\"token interpolation\"><span class=\"token punctuation\">{</span><span class=\"token expression language-csharp\">count <span class=\"token operator\">-</span> <span class=\"token number\">1</span></span><span class=\"token punctuation\">}</span></span><span class=\"token string\">\"</span></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  \n                <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>httpClientResponse<span class=\"token punctuation\">.</span>IsSuccessStatusCode<span class=\"token punctuation\">)</span>  \n                <span class=\"token punctuation\">{</span>  \n                    <span class=\"token class-name\"><span class=\"token keyword\">var</span></span> text <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> httpClientResponse<span class=\"token punctuation\">.</span>Content<span class=\"token punctuation\">.</span><span class=\"token function\">ReadAsStringAsync</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  \n                    msg <span class=\"token operator\">=</span> <span class=\"token interpolation-string\"><span class=\"token string\">$\"Hello World! (x</span><span class=\"token interpolation\"><span class=\"token punctuation\">{</span><span class=\"token expression language-csharp\">count</span><span class=\"token punctuation\">}</span></span><span class=\"token string\">)\\n\"</span></span> <span class=\"token operator\">+</span> text<span class=\"token punctuation\">;</span>  \n                <span class=\"token punctuation\">}</span>  \n            <span class=\"token punctuation\">}</span>  \n        <span class=\"token punctuation\">}</span>  \n\n        <span class=\"token class-name\">HttpResponseMessage</span> response <span class=\"token operator\">=</span> Request<span class=\"token punctuation\">.</span><span class=\"token function\">CreateResponse</span><span class=\"token punctuation\">(</span>HttpStatusCode<span class=\"token punctuation\">.</span>OK<span class=\"token punctuation\">,</span> <span class=\"token string\">\"value\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  \n        response<span class=\"token punctuation\">.</span>Content <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token constructor-invocation class-name\">StringContent</span><span class=\"token punctuation\">(</span>msg<span class=\"token punctuation\">,</span> Encoding<span class=\"token punctuation\">.</span>UTF8<span class=\"token punctuation\">,</span> <span class=\"token string\">\"text/plain\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  \n\n        <span class=\"token keyword\">return</span> response<span class=\"token punctuation\">;</span>  \n    <span class=\"token punctuation\">}</span>  \n<span class=\"token punctuation\">}</span>  </code></pre></div>\n<p>There was a bug with the NuGet version, so needed to compile from source and make a fix (see <a href=\"https://github.com/mdsol/Medidata.ZipkinTracerModule/pull/91\">Pull Request #91</a>).  Also, C# code may look a bit ugly, and wasn’t able to get Unity working to dependency inject the <code class=\"language-text\">ZipkinConfig</code> data.</p>\n<p>The final result from <code class=\"language-text\">http://10.194.52.207:9411/traces/4e3c247d68677a1e?serviceName=localhost</code>.</p>\n<div class=\"gatsby-highlight\" data-language=\"json\"><pre class=\"language-json\"><code class=\"language-json\"><span class=\"token punctuation\">[</span>  \n  <span class=\"token punctuation\">{</span>  \n    <span class=\"token property\">\"traceId\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"4e3c247d68677a1e\"</span><span class=\"token punctuation\">,</span>  \n    <span class=\"token property\">\"name\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"get\"</span><span class=\"token punctuation\">,</span>  \n    <span class=\"token property\">\"id\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"4e3c247d68677a1e\"</span><span class=\"token punctuation\">,</span>  \n    <span class=\"token property\">\"timestamp\"</span><span class=\"token operator\">:</span> <span class=\"token number\">1469831966269543</span><span class=\"token punctuation\">,</span>  \n    <span class=\"token property\">\"duration\"</span><span class=\"token operator\">:</span> <span class=\"token number\">210907</span><span class=\"token punctuation\">,</span>  \n    <span class=\"token property\">\"annotations\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>  \n      <span class=\"token punctuation\">{</span>  \n        <span class=\"token property\">\"endpoint\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>  \n          <span class=\"token property\">\"serviceName\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"localhost\"</span><span class=\"token punctuation\">,</span>  \n          <span class=\"token property\">\"ipv4\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"10.211.55.8\"</span><span class=\"token punctuation\">,</span>  \n          <span class=\"token property\">\"port\"</span><span class=\"token operator\">:</span> <span class=\"token number\">52399</span>  \n        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>  \n        <span class=\"token property\">\"timestamp\"</span><span class=\"token operator\">:</span> <span class=\"token number\">1469831966269543</span><span class=\"token punctuation\">,</span>  \n        <span class=\"token property\">\"value\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"sr\"</span>  \n      <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>  \n      <span class=\"token punctuation\">{</span>  \n        <span class=\"token property\">\"endpoint\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>  \n          <span class=\"token property\">\"serviceName\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"localhost\"</span><span class=\"token punctuation\">,</span>  \n          <span class=\"token property\">\"ipv4\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"10.211.55.8\"</span><span class=\"token punctuation\">,</span>  \n          <span class=\"token property\">\"port\"</span><span class=\"token operator\">:</span> <span class=\"token number\">52399</span>  \n        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>  \n        <span class=\"token property\">\"timestamp\"</span><span class=\"token operator\">:</span> <span class=\"token number\">1469831966480450</span><span class=\"token punctuation\">,</span>  \n        <span class=\"token property\">\"value\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"ss\"</span>  \n      <span class=\"token punctuation\">}</span>  \n    <span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>  \n    <span class=\"token property\">\"binaryAnnotations\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>  \n      <span class=\"token punctuation\">{</span>  \n        <span class=\"token property\">\"key\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"http.path\"</span><span class=\"token punctuation\">,</span>  \n        <span class=\"token property\">\"value\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"/api/hello\"</span><span class=\"token punctuation\">,</span>  \n        <span class=\"token property\">\"endpoint\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>  \n          <span class=\"token property\">\"serviceName\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"localhost\"</span><span class=\"token punctuation\">,</span>  \n          <span class=\"token property\">\"ipv4\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"10.211.55.8\"</span><span class=\"token punctuation\">,</span>  \n          <span class=\"token property\">\"port\"</span><span class=\"token operator\">:</span> <span class=\"token number\">52399</span>  \n        <span class=\"token punctuation\">}</span>  \n      <span class=\"token punctuation\">}</span>  \n    <span class=\"token punctuation\">]</span>  \n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>  \n  <span class=\"token punctuation\">{</span>  \n    <span class=\"token property\">\"traceId\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"4e3c247d68677a1e\"</span><span class=\"token punctuation\">,</span>  \n    <span class=\"token property\">\"name\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"get\"</span><span class=\"token punctuation\">,</span>  \n    <span class=\"token property\">\"id\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"4c3c03caf1337298\"</span><span class=\"token punctuation\">,</span>  \n    <span class=\"token property\">\"parentId\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"4e3c247d68677a1e\"</span><span class=\"token punctuation\">,</span>  \n    <span class=\"token property\">\"timestamp\"</span><span class=\"token operator\">:</span> <span class=\"token number\">1469831966361425</span><span class=\"token punctuation\">,</span>  \n    <span class=\"token property\">\"duration\"</span><span class=\"token operator\">:</span> <span class=\"token number\">100997</span><span class=\"token punctuation\">,</span>  \n    <span class=\"token property\">\"annotations\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>  \n      <span class=\"token punctuation\">{</span>  \n        <span class=\"token property\">\"endpoint\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>  \n          <span class=\"token property\">\"serviceName\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"localhost\"</span><span class=\"token punctuation\">,</span>  \n          <span class=\"token property\">\"ipv4\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"10.211.55.8\"</span><span class=\"token punctuation\">,</span>  \n          <span class=\"token property\">\"port\"</span><span class=\"token operator\">:</span> <span class=\"token number\">52399</span>  \n        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>  \n        <span class=\"token property\">\"timestamp\"</span><span class=\"token operator\">:</span> <span class=\"token number\">1469831966361425</span><span class=\"token punctuation\">,</span>  \n        <span class=\"token property\">\"value\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"cs\"</span>  \n      <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>  \n      <span class=\"token punctuation\">{</span>  \n        <span class=\"token property\">\"endpoint\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>  \n          <span class=\"token property\">\"serviceName\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"localhost\"</span><span class=\"token punctuation\">,</span>  \n          <span class=\"token property\">\"ipv4\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"10.211.55.8\"</span><span class=\"token punctuation\">,</span>  \n          <span class=\"token property\">\"port\"</span><span class=\"token operator\">:</span> <span class=\"token number\">52399</span>  \n        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>  \n        <span class=\"token property\">\"timestamp\"</span><span class=\"token operator\">:</span> <span class=\"token number\">1469831966383550</span><span class=\"token punctuation\">,</span>  \n        <span class=\"token property\">\"value\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"sr\"</span>  \n      <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>  \n      <span class=\"token punctuation\">{</span>  \n        <span class=\"token property\">\"endpoint\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>  \n          <span class=\"token property\">\"serviceName\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"localhost\"</span><span class=\"token punctuation\">,</span>  \n          <span class=\"token property\">\"ipv4\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"10.211.55.8\"</span><span class=\"token punctuation\">,</span>  \n          <span class=\"token property\">\"port\"</span><span class=\"token operator\">:</span> <span class=\"token number\">52399</span>  \n        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>  \n        <span class=\"token property\">\"timestamp\"</span><span class=\"token operator\">:</span> <span class=\"token number\">1469831966449422</span><span class=\"token punctuation\">,</span>  \n        <span class=\"token property\">\"value\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"cr\"</span>  \n      <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>  \n      <span class=\"token punctuation\">{</span>  \n        <span class=\"token property\">\"endpoint\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>  \n          <span class=\"token property\">\"serviceName\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"localhost\"</span><span class=\"token punctuation\">,</span>  \n          <span class=\"token property\">\"ipv4\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"10.211.55.8\"</span><span class=\"token punctuation\">,</span>  \n          <span class=\"token property\">\"port\"</span><span class=\"token operator\">:</span> <span class=\"token number\">52399</span>  \n        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>  \n        <span class=\"token property\">\"timestamp\"</span><span class=\"token operator\">:</span> <span class=\"token number\">1469831966462422</span><span class=\"token punctuation\">,</span>  \n        <span class=\"token property\">\"value\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"ss\"</span>  \n      <span class=\"token punctuation\">}</span>  \n    <span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>  \n    <span class=\"token property\">\"binaryAnnotations\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>  \n      <span class=\"token punctuation\">{</span>  \n        <span class=\"token property\">\"key\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"http.path\"</span><span class=\"token punctuation\">,</span>  \n        <span class=\"token property\">\"value\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"/api/hello\"</span><span class=\"token punctuation\">,</span>  \n        <span class=\"token property\">\"endpoint\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>  \n          <span class=\"token property\">\"serviceName\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"localhost\"</span><span class=\"token punctuation\">,</span>  \n          <span class=\"token property\">\"ipv4\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"10.211.55.8\"</span><span class=\"token punctuation\">,</span>  \n          <span class=\"token property\">\"port\"</span><span class=\"token operator\">:</span> <span class=\"token number\">52399</span>  \n        <span class=\"token punctuation\">}</span>  \n      <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>  \n      <span class=\"token punctuation\">{</span>  \n        <span class=\"token property\">\"key\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"http.status\"</span><span class=\"token punctuation\">,</span>  \n        <span class=\"token property\">\"value\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"200\"</span><span class=\"token punctuation\">,</span>  \n        <span class=\"token property\">\"endpoint\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>  \n          <span class=\"token property\">\"serviceName\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"localhost\"</span><span class=\"token punctuation\">,</span>  \n          <span class=\"token property\">\"ipv4\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"10.211.55.8\"</span><span class=\"token punctuation\">,</span>  \n          <span class=\"token property\">\"port\"</span><span class=\"token operator\">:</span> <span class=\"token number\">52399</span>  \n        <span class=\"token punctuation\">}</span>  \n      <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>  \n      <span class=\"token punctuation\">{</span>  \n        <span class=\"token property\">\"key\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"sa\"</span><span class=\"token punctuation\">,</span>  \n        <span class=\"token property\">\"value\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"1\"</span><span class=\"token punctuation\">,</span>  \n        <span class=\"token property\">\"endpoint\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>  \n          <span class=\"token property\">\"serviceName\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"localhost\"</span><span class=\"token punctuation\">,</span>  \n          <span class=\"token property\">\"ipv4\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"127.0.0.1\"</span><span class=\"token punctuation\">,</span>  \n          <span class=\"token property\">\"port\"</span><span class=\"token operator\">:</span> <span class=\"token number\">52399</span>  \n        <span class=\"token punctuation\">}</span>  \n      <span class=\"token punctuation\">}</span>  \n    <span class=\"token punctuation\">]</span>  \n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>  \n  <span class=\"token punctuation\">{</span>  \n    <span class=\"token property\">\"traceId\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"4e3c247d68677a1e\"</span><span class=\"token punctuation\">,</span>  \n    <span class=\"token property\">\"name\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"get\"</span><span class=\"token punctuation\">,</span>  \n    <span class=\"token property\">\"id\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"4f18dc0c1c6745e0\"</span><span class=\"token punctuation\">,</span>  \n    <span class=\"token property\">\"parentId\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"4c3c03caf1337298\"</span><span class=\"token punctuation\">,</span>  \n    <span class=\"token property\">\"timestamp\"</span><span class=\"token operator\">:</span> <span class=\"token number\">1469831966398553</span><span class=\"token punctuation\">,</span>  \n    <span class=\"token property\">\"duration\"</span><span class=\"token operator\">:</span> <span class=\"token number\">63869</span><span class=\"token punctuation\">,</span>  \n    <span class=\"token property\">\"annotations\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>  \n      <span class=\"token punctuation\">{</span>  \n        <span class=\"token property\">\"endpoint\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>  \n          <span class=\"token property\">\"serviceName\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"localhost\"</span><span class=\"token punctuation\">,</span>  \n          <span class=\"token property\">\"ipv4\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"10.211.55.8\"</span><span class=\"token punctuation\">,</span>  \n          <span class=\"token property\">\"port\"</span><span class=\"token operator\">:</span> <span class=\"token number\">52399</span>  \n        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>  \n        <span class=\"token property\">\"timestamp\"</span><span class=\"token operator\">:</span> <span class=\"token number\">1469831966398553</span><span class=\"token punctuation\">,</span>  \n        <span class=\"token property\">\"value\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"cs\"</span>  \n      <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>  \n      <span class=\"token punctuation\">{</span>  \n        <span class=\"token property\">\"endpoint\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>  \n          <span class=\"token property\">\"serviceName\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"localhost\"</span><span class=\"token punctuation\">,</span>  \n          <span class=\"token property\">\"ipv4\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"10.211.55.8\"</span><span class=\"token punctuation\">,</span>  \n          <span class=\"token property\">\"port\"</span><span class=\"token operator\">:</span> <span class=\"token number\">52399</span>  \n        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>  \n        <span class=\"token property\">\"timestamp\"</span><span class=\"token operator\">:</span> <span class=\"token number\">1469831966417424</span><span class=\"token punctuation\">,</span>  \n        <span class=\"token property\">\"value\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"sr\"</span>  \n      <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>  \n      <span class=\"token punctuation\">{</span>  \n        <span class=\"token property\">\"endpoint\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>  \n          <span class=\"token property\">\"serviceName\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"localhost\"</span><span class=\"token punctuation\">,</span>  \n          <span class=\"token property\">\"ipv4\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"10.211.55.8\"</span><span class=\"token punctuation\">,</span>  \n          <span class=\"token property\">\"port\"</span><span class=\"token operator\">:</span> <span class=\"token number\">52399</span>  \n        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>  \n        <span class=\"token property\">\"timestamp\"</span><span class=\"token operator\">:</span> <span class=\"token number\">1469831966445425</span><span class=\"token punctuation\">,</span>  \n        <span class=\"token property\">\"value\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"cr\"</span>  \n      <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>  \n      <span class=\"token punctuation\">{</span>  \n        <span class=\"token property\">\"endpoint\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>  \n          <span class=\"token property\">\"serviceName\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"localhost\"</span><span class=\"token punctuation\">,</span>  \n          <span class=\"token property\">\"ipv4\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"10.211.55.8\"</span><span class=\"token punctuation\">,</span>  \n          <span class=\"token property\">\"port\"</span><span class=\"token operator\">:</span> <span class=\"token number\">52399</span>  \n        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>  \n        <span class=\"token property\">\"timestamp\"</span><span class=\"token operator\">:</span> <span class=\"token number\">1469831966462422</span><span class=\"token punctuation\">,</span>  \n        <span class=\"token property\">\"value\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"ss\"</span>  \n      <span class=\"token punctuation\">}</span>  \n    <span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>  \n    <span class=\"token property\">\"binaryAnnotations\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>  \n      <span class=\"token punctuation\">{</span>  \n        <span class=\"token property\">\"key\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"http.path\"</span><span class=\"token punctuation\">,</span>  \n        <span class=\"token property\">\"value\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"/api/hello\"</span><span class=\"token punctuation\">,</span>  \n        <span class=\"token property\">\"endpoint\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>  \n          <span class=\"token property\">\"serviceName\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"localhost\"</span><span class=\"token punctuation\">,</span>  \n          <span class=\"token property\">\"ipv4\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"10.211.55.8\"</span><span class=\"token punctuation\">,</span>  \n          <span class=\"token property\">\"port\"</span><span class=\"token operator\">:</span> <span class=\"token number\">52399</span>  \n        <span class=\"token punctuation\">}</span>  \n      <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>  \n      <span class=\"token punctuation\">{</span>  \n        <span class=\"token property\">\"key\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"http.status\"</span><span class=\"token punctuation\">,</span>  \n        <span class=\"token property\">\"value\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"200\"</span><span class=\"token punctuation\">,</span>  \n        <span class=\"token property\">\"endpoint\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>  \n          <span class=\"token property\">\"serviceName\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"localhost\"</span><span class=\"token punctuation\">,</span>  \n          <span class=\"token property\">\"ipv4\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"10.211.55.8\"</span><span class=\"token punctuation\">,</span>  \n          <span class=\"token property\">\"port\"</span><span class=\"token operator\">:</span> <span class=\"token number\">52399</span>  \n        <span class=\"token punctuation\">}</span>  \n      <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>  \n      <span class=\"token punctuation\">{</span>  \n        <span class=\"token property\">\"key\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"sa\"</span><span class=\"token punctuation\">,</span>  \n        <span class=\"token property\">\"value\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"1\"</span><span class=\"token punctuation\">,</span>  \n        <span class=\"token property\">\"endpoint\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>  \n          <span class=\"token property\">\"serviceName\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"localhost\"</span><span class=\"token punctuation\">,</span>  \n          <span class=\"token property\">\"ipv4\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"127.0.0.1\"</span><span class=\"token punctuation\">,</span>  \n          <span class=\"token property\">\"port\"</span><span class=\"token operator\">:</span> <span class=\"token number\">52399</span>  \n        <span class=\"token punctuation\">}</span>  \n      <span class=\"token punctuation\">}</span>  \n    <span class=\"token punctuation\">]</span>  \n  <span class=\"token punctuation\">}</span>  \n<span class=\"token punctuation\">]</span></code></pre></div>","frontmatter":{"title":".NET Zipkin Investigation (Medidata.ZipkinTracerModule)","description":null,"date":"July 29, 2016","tags":["dotnet","api","monitoring"],"canonical":null}}},"pageContext":{"slug":"/2016-07-29-net-zipkin-investigation-medidatazipkintracermodule","previous":{"fields":{"slug":"/2016-07-20-zipkin-js-investigation-part-2"},"frontmatter":{"tags":["javascript","api","monitoring"]}},"next":{"fields":{"slug":"/2016-08-15-how-iam-roles-become-credentials-on-ec2"},"frontmatter":{"tags":["aws","iam","security"]}}}},"staticQueryHashes":["2589769190","3567236516"]}