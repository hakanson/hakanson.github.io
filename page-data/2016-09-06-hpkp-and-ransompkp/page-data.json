{"componentChunkName":"component---src-templates-blog-post-js","path":"/2016-09-06-hpkp-and-ransompkp","result":{"data":{"site":{"siteMetadata":{"title":"kevinhakanson.com","author":"Kevin Hakanson"}},"markdownRemark":{"id":"a7eca239-adc0-595e-a49a-652ae9a741be","excerpt":"In Pokemon Go vs. Certificate Pinning I explored RFC 7469 - Public Key Pinning Extension for HTTP and the HPKP header.  This looked like something that was…","html":"<p>In <a href=\"../2016-07-11-pokemon-go-vs-certificate-pinning\">Pokemon Go vs. Certificate Pinning</a> I explored <a href=\"https://tools.ietf.org/html/rfc7469\">RFC 7469 - Public Key Pinning Extension for HTTP</a> and the HPKP header.  This looked like something that was complicated to implement if you didn’t have a very mature key management process that already knew about future certificates’ public keys.  I was a little scared, since I could see a scenario where someone sets this header without completely thinking it through - and locks out paying customers from accessing our products.</p>\n<p>Today, I read <a href=\"https://blog.qualys.com/ssllabs/2016/09/06/is-http-public-key-pinning-dead\">Is HTTP Public Key Pinning Dead?</a> and was introduced to the concept of <strong>RansomPKP</strong> and I am even more scared.  In <a href=\"https://scotthelme.co.uk/using-security-features-to-do-bad-things/\">Using security features to do bad things</a>, Scott Helme explains how an attacker who has access to your server’s HTTP response headers could generate a public key that you don’t have access to, lock your customers out of your website for the next 60 days, and then ransom that key back to you.</p>\n<p>It gets worse since HPKP has the <code class=\"language-text\">includeSubDomains</code> feature:</p>\n<blockquote>\n<p>If this optional parameter is specified, this rule applies to all of the site’s subdomains as well.</p>\n</blockquote>\n<p>Now suppose somebody applies RansomPKP to our naked domain server (e.g., example.com) and includes the includeSubDomains option?  Could they ransom multiple company products all at once?  Our public facing website is now an attack vector for other unrelated properties.</p>\n<p>All hope is not lost.  <a href=\"https://blog.qualys.com/ssllabs/2016/09/06/is-http-public-key-pinning-dead\">Is HTTP Public Key Pinning Dead?</a> did have some ideas in a “What can you do today?” section, including just stripping that header in your reverse proxy / load balancer. Alternatively, you can implement HPKP yourself (and only be a little scared).</p>","frontmatter":{"title":"HPKP and RansomPKP","description":null,"date":"September 06, 2016","tags":["http","security","webdev"],"canonical":null}}},"pageContext":{"slug":"/2016-09-06-hpkp-and-ransompkp","previous":{"fields":{"slug":"/2016-09-01-smaller-and-faster-data-compression-with-zstandard"},"frontmatter":{"tags":["webdev"]}},"next":{"fields":{"slug":"/2016-10-11-i-have-people-skills"},"frontmatter":{"tags":["career"]}}}},"staticQueryHashes":["2589769190","3567236516"]}