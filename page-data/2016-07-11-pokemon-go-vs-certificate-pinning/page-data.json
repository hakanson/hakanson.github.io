{"componentChunkName":"component---src-templates-blog-post-js","path":"/2016-07-11-pokemon-go-vs-certificate-pinning","result":{"data":{"site":{"siteMetadata":{"title":"kevinhakanson.com","author":"Kevin Hakanson"}},"markdownRemark":{"id":"8949182b-ddda-5fe6-ba91-3786d3ed95a7","excerpt":"Saw this Tweet from @notdan about the Pokémon Go video game and their lack of certificate pinning:  At first, I thought “duh, of course, they should have” but…","html":"<p>Saw this Tweet from <a href=\"https://twitter.com/notdan\">@notdan</a> about the <a href=\"http://www.pokemon.com/us/pokemon-video-games/pokemon-go/\">Pokémon Go</a> video game and their lack of certificate pinning:</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 576px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/75420e960ee1f202ea382dc034510785/533c1/pastedImage_9.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 29.72972972972973%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAYAAADDl76dAAAACXBIWXMAAAsTAAALEwEAmpwYAAABFUlEQVQY042RsU/CQByF+886OhoX/Q9wMC4aBxd3B2cndTIOUKC0hdIr0FZBSHu9K2DoZ+5InIzhJZf38nL53vBznh4fuLts8TX/RCQTqqrCqGmaf9+uaai14rZdcfIsOX2RXLxXOPc3V5wfHyHGEZ2+T1lKDtV2XXPdrizs7LWg9VbirJYLlvOcoihRukbrmrIsUUrZTtem05RSWpdS2qy0pigKdhvNbq1/R5ws/8DteQThkDgW9PoebdclFoKO22Ucx0xnMzpdkwV+ENg/fW9gPRxFDIKQSik2228DzAmHQ9Is20NFwiiKML0BmZH5YrHPIrHQNMvt4HSWkqYZyWRi++VqhSOSBG/g44eh9b9kjnCofgAKVr761DvCUgAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"@notdan Pokemon Go Tweet\"\n        title=\"@notdan Pokemon Go Tweet\"\n        src=\"/static/75420e960ee1f202ea382dc034510785/533c1/pastedImage_9.png\"\n        srcset=\"/static/75420e960ee1f202ea382dc034510785/12f09/pastedImage_9.png 148w,\n/static/75420e960ee1f202ea382dc034510785/e4a3f/pastedImage_9.png 295w,\n/static/75420e960ee1f202ea382dc034510785/533c1/pastedImage_9.png 576w\"\n        sizes=\"(max-width: 576px) 100vw, 576px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<p>At first, I thought “duh, of course, they should have” but then I realized that I need to understand <a href=\"https://www.owasp.org/index.php/Certificate_and_Public_Key_Pinning\">Certificate and Public Key Pinning</a> better.  I’ve known about <a href=\"https://tools.ietf.org/html/rfc7469\">RFC 7469 - Public Key Pinning Extension for HTTP</a> and the HPKP header for a while, but never implemented it for any web applications (where the browser does the check) nor for any mobile/desktop applications (where you need to code the check yourself).</p>\n<p>I read though <a href=\"https://scotthelme.co.uk/hpkp-http-public-key-pinning/\">HPKP: HTTP Public Key Pinning</a> to see how these pins work.  I grabbed the <code class=\"language-text\">Public-Key-Pins</code> header from that blog post using a curl command:</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">$ <span class=\"token function\">curl</span> <span class=\"token parameter variable\">-sI</span> <span class=\"token string\">\"https://scotthelme.co.uk/hpkp-http-public-key-pinning/\"</span> <span class=\"token operator\">|</span> <span class=\"token function\">grep</span> <span class=\"token parameter variable\">-Fi</span> public-key-pins\r\n\r\nPublic-Key-Pins: pin-sha256<span class=\"token operator\">=</span><span class=\"token string\">\"X3pGTSOuJeEVw989IJ/cEtXUEmy52zs1TZQrU06KUKg=\"</span><span class=\"token punctuation\">;</span> pin-sha256<span class=\"token operator\">=</span><span class=\"token string\">\"MHJYVThihUrJcxW6wcqyOISTXIsInsdj3xK8QrZbHec=\"</span><span class=\"token punctuation\">;</span> pin-sha256<span class=\"token operator\">=</span><span class=\"token string\">\"isi41AizREkLvvft0IRW4u3XMFR2Yg7bvrF7padyCJg=\"</span><span class=\"token punctuation\">;</span> pin-sha256<span class=\"token operator\">=</span><span class=\"token string\">\"I/bAACUzdYEFNw2ZKRaypOyYvvOtqBzg21g9a5WVClg=\"</span><span class=\"token punctuation\">;</span> pin-sha256<span class=\"token operator\">=</span><span class=\"token string\">\"Y4/Gxyck5JLLnC/zWHtSHfNljuMbOJi6dRQuRJTgYdo=\"</span><span class=\"token punctuation\">;</span> pin-sha256<span class=\"token operator\">=</span><span class=\"token string\">\"/oCVQg3nP3DroGpFdAbaiYzenycUftqrH3LAyaIal2g=\"</span><span class=\"token punctuation\">;</span> pin-sha256<span class=\"token operator\">=</span><span class=\"token string\">\"0PiItvsnLZy1slbsVPGky8YnDsJavMNtxD0TPwsCdC8=\"</span><span class=\"token punctuation\">;</span> pin-sha256<span class=\"token operator\">=</span><span class=\"token string\">\"t3EPvqF+7XoKypCPHyN1b5uey7zTfIGDHn4oBWz2pds=\"</span><span class=\"token punctuation\">;</span> pin-sha256<span class=\"token operator\">=</span><span class=\"token string\">\"zqbcEslrpiH0bA9uhNyl2ovpLEfGJQM/QvZSVumMFJ8=\"</span><span class=\"token punctuation\">;</span> pin-sha256<span class=\"token operator\">=</span><span class=\"token string\">\"V+J+7lHvE6X0pqGKVqLtxuvk+0f+xowyr3obtq8tbSw=\"</span><span class=\"token punctuation\">;</span> pin-sha256<span class=\"token operator\">=</span><span class=\"token string\">\"Myokb3mG16eRkVBE+ZmFSKSpYQzWHKMY1MZbXgA8BkQ=\"</span><span class=\"token punctuation\">;</span> pin-sha256<span class=\"token operator\">=</span><span class=\"token string\">\"WSg/oQliyMYyP6yZ0CzDdQ8PHmtUkoUsOsa5svxxXxo=\"</span><span class=\"token punctuation\">;</span> pin-sha256<span class=\"token operator\">=</span><span class=\"token string\">\"9lBW+k9EF6yyG9413/fPiHhQy5Ok4UI5sBpBTuOaa/U=\"</span><span class=\"token punctuation\">;</span> pin-sha256<span class=\"token operator\">=</span><span class=\"token string\">\"ipMu2Xu72A086/35thucbjLfrPaSjuw4HIjSWsxqkb8=\"</span><span class=\"token punctuation\">;</span> pin-sha256<span class=\"token operator\">=</span><span class=\"token string\">\"6OnjvIKf0SxyerXzg9N0RvQ2sgaL6niV+MLn9wBrh+s=\"</span><span class=\"token punctuation\">;</span> pin-sha256<span class=\"token operator\">=</span><span class=\"token string\">\"9dNiZZueNZmyaf3pTkXxDgOzLkjKvI+Nza0ACF5IDwg=\"</span><span class=\"token punctuation\">;</span> max-age<span class=\"token operator\">=</span><span class=\"token number\">2592000</span><span class=\"token punctuation\">;</span> includeSubDomains<span class=\"token punctuation\">;</span> report-uri<span class=\"token operator\">=</span><span class=\"token string\">\"https://scotthelme.report-uri.io/r/default/hpkp/enforce\"</span></code></pre></div>\n<p>I generated the same value as one of the pins (thanks to the example from <a href=\"https://developer.mozilla.org/en-US/docs/Web/Security/Public_Key_Pinning\">Public Key Pinning - Web security | MDN</a> ):</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">$ openssl s_client <span class=\"token parameter variable\">-servername</span> scotthelme.co.uk <span class=\"token parameter variable\">-connect</span> scotthelme.co.uk:443 <span class=\"token punctuation\">\\</span>\r\n<span class=\"token operator\">|</span> openssl x509 <span class=\"token parameter variable\">-pubkey</span> <span class=\"token parameter variable\">-noout</span> <span class=\"token punctuation\">\\</span>\r\n<span class=\"token operator\">|</span> openssl rsa <span class=\"token parameter variable\">-pubin</span> <span class=\"token parameter variable\">-outform</span> der <span class=\"token punctuation\">\\</span>\r\n<span class=\"token operator\">|</span> openssl dgst <span class=\"token parameter variable\">-sha256</span> <span class=\"token parameter variable\">-binary</span> <span class=\"token punctuation\">\\</span>\r\n<span class=\"token operator\">|</span> openssl enc <span class=\"token parameter variable\">-base64</span>\r\n<span class=\"token assign-left variable\">depth</span><span class=\"token operator\">=</span><span class=\"token number\">1</span> /C<span class=\"token operator\">=</span>US/O<span class=\"token operator\">=</span>Let<span class=\"token string\">'s Encrypt/CN=Let'</span>s Encrypt Authority X3\r\nverify error:num<span class=\"token operator\">=</span><span class=\"token number\">20</span>:unable to get <span class=\"token builtin class-name\">local</span> issuer certificate\r\nverify return:0\r\nwriting RSA key\r\nX3pGTSOuJeEVw989IJ/cEtXUEmy52zs1TZQrU06KUKg<span class=\"token operator\">=</span></code></pre></div>\n<p>Now that I’ve leveled up my InfoSec skills, maybe I should go learn more about Pokemon?</p>\n<p><strong>Update</strong>: I was a little scared to login with my Google Account and give the app “Full Account Access” (see <a href=\"http://arstechnica.com/gaming/2016/07/pokemon-go-on-ios-gets-full-access-to-your-google-account/\">iOS version of Pokémon Go is a possible privacy trainwreck | Ars Technica</a> ) but after reading\r\n<a href=\"https://www.theguardian.com/technology/2016/jul/11/pokemon-go-privacy-security-full-access-google-account\">Have you given Pokémon Go full access to everything in your Google account? | Technology | The Guardian</a>  things might not be that bad.</p>","frontmatter":{"title":"Pokemon Go vs. Certificate Pinning","description":null,"date":"July 11, 2016","tags":["http","security","pokemon"],"canonical":null}}},"pageContext":{"slug":"/2016-07-11-pokemon-go-vs-certificate-pinning","previous":{"fields":{"slug":"/2016-06-30-software-customization-taxonomy"},"frontmatter":{"tags":["architecture","saas"]}},"next":{"fields":{"slug":"/2016-07-20-zipkin-js-investigation-part-2"},"frontmatter":{"tags":["javascript","api","monitoring"]}}}},"staticQueryHashes":["2589769190","97908498"]}