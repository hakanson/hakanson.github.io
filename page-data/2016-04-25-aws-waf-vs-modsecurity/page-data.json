{"componentChunkName":"component---src-templates-blog-post-js","path":"/2016-04-25-aws-waf-vs-modsecurity","result":{"data":{"site":{"siteMetadata":{"title":"kevinhakanson.com","author":"Kevin Hakanson"}},"markdownRemark":{"id":"d9e68779-43f5-50dc-9249-cf6ae28671ec","excerpt":"In a recent meeting with the corporate security team, it was mentioned that a Web Application Firewall (WAF) might be the recommendation for cloud projects to…","html":"<p>In a recent meeting with the corporate security team, it was mentioned that a Web Application Firewall (WAF) might be the recommendation for cloud projects to protect against XSS and SQL Injection.  The Cloud Security Workstream has done some research, including WAF options.  As I dug into what an AWS WAF solution might look like, I came up with this diagram:</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/7157823f3bdb46f3be99ca89a554e0d7/1cfc2/AWS%2BStatic%2BContent%2B-%2BAWS%2BWAF.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 62.16216216216216%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAYAAABiDJ37AAAACXBIWXMAABibAAAYmwFJdYOUAAACSklEQVR42pWSu24TURCG/RY8AS2PQo3gARAlaQApBREN0CCaCCSklBThIlJQJFKCEFIumIBiAnbiJLbX3pvX3ru9V39oju2EiIojjc6ec2b+/eefvzKZTJiHWlnAxNyG+fk/V+Xic0IORGefYOsGiV0jjDMC3ycMA47P2iy9r/HlsIPZ02i12miGjaZptFst+v0+eZ5TEWZZlqmD7GEUEpoakaWTl1OW4zjipOfw+F2Vre19iiInjkcEWkP9MBqnGLqO7/tUkiQhCALCMMQPQxq1AzYfLLD3aBHj5JgwjtF1Hc/3YfsVvL1LYTVJC/Be3iJ6cx8mOaZl4XneFLD6bZ9arcbQ8xRg9ckSx8vP6DTqKtE0DHTDpL/2FGflDkHrAG+U4Xxfx168RvpzA8sN8dzhVEPRodfrURQFznDIYXWP+n6VaDQijmOGgwFZUeIaHX5//XyuepIV6I0fFKMQy7LxheHfExJAAdcsh5Zu4TiO0tWyLFzXZVRMiLMCTddpNpsYhkGSl0RxjG3bShY1lLIsp47JMvXo1ncY1HcpZ0Pp2zZJmtL+sMrOw3v4WocsL0jTlDzPlOWiKJpqqAwz85wkjNOc+vJtTlYWmDtR2u5qGns3r/P66hW6Gx9nTrvwqgxVurgMmIxJgaOtVazdtVlRyXg8Js1zupvr/HrxnNjpK8YikYTUi1P+YSgty4NMtN3RzgsEUDSyhkNs16U/GHB6eqpYSb74T8Ck7UuAoqVcxnGk2pQCCbkzTVO13et21ZvYTfZ5SI7U/wFi0oJoIkjYcQAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"AWS Static Content - AWS WAF.png\"\n        title=\"\"\n        src=\"/static/7157823f3bdb46f3be99ca89a554e0d7/fcda8/AWS%2BStatic%2BContent%2B-%2BAWS%2BWAF.png\"\n        srcset=\"/static/7157823f3bdb46f3be99ca89a554e0d7/12f09/AWS%2BStatic%2BContent%2B-%2BAWS%2BWAF.png 148w,\n/static/7157823f3bdb46f3be99ca89a554e0d7/e4a3f/AWS%2BStatic%2BContent%2B-%2BAWS%2BWAF.png 295w,\n/static/7157823f3bdb46f3be99ca89a554e0d7/fcda8/AWS%2BStatic%2BContent%2B-%2BAWS%2BWAF.png 590w,\n/static/7157823f3bdb46f3be99ca89a554e0d7/efc66/AWS%2BStatic%2BContent%2B-%2BAWS%2BWAF.png 885w,\n/static/7157823f3bdb46f3be99ca89a554e0d7/1cfc2/AWS%2BStatic%2BContent%2B-%2BAWS%2BWAF.png 900w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<p>Since <a href=\"https://aws.amazon.com/waf/\">AWS WAF</a> and its <a href=\"http://docs.aws.amazon.com/waf/latest/developerguide/web-acl.html\">Web ACL</a> rules are a feature of the <a href=\"https://aws.amazon.com/cloudfront/\">Amazon CloudFront CDN</a>, a full solution would pull in other Amazon functionality.  CloudFront is most useful as a CDN, if you host your static content assets in S3.  You can configure both an S3 Origin for your static content and a Custom Origin for your dynamic content.  In the diagram above, a “behavior” with the “path prefix” of <code class=\"language-text\">api/*</code> was used to route application requests to the ELB.</p>\n<p>However, this solution requires some DNS changes.  CloudFront will now be configured for application hostname, and the ELB needs a new hostname.  This is where things become interesting.  In the classic <code class=\"language-text\">www.example.com</code> scenario, you make CloudFront respond to <code class=\"language-text\">www.example.com</code>, and your original ELB becomes something like <code class=\"language-text\">origin-www.example.com</code>, reflecting the fact it is the “Origin” server.  Our products use “naked” domains meaning <code class=\"language-text\">example.com</code> is the hostname instead of the more traditional <code class=\"language-text\">www.example.com</code>.  This makes the naming of <code class=\"language-text\">origin.example.com</code> harder (since <code class=\"language-text\">origin-example.com</code> would be a new domain).  It also may require us to use Route 53 for DNS because the requirement for an ALIAS record for the zone apex (see <a href=\"http://docs.aws.amazon.com/Route53/latest/DeveloperGuide/resource-record-sets-choosing-alias-non-alias.html\">Choosing Between Alias and Non-Alias Resource Record Sets - Amazon Route 53</a>).  This topic needs more investigation.</p>\n<p>Earlier, I investigated putting Apache HTTP in front of Zuul and use the ProxyPass directive to pass any <code class=\"language-text\">/api</code> URIs.  This was for HTTP/2 protocol support, but could also be used if we use the <a href=\"https://www.modsecurity.org/\">ModSecurity</a> Apache module as a WAF.  This solution means no new hostnames, less new infrastructure and could also be used by the deployments in the corporate data center until they can move to AWS.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/f749210300bc0c5cd0f4930b0586f413/b12f7/AWS%2BStatic%2BContent%2B-%2BModSecurity.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 35.13513513513513%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAYAAAAIy204AAAACXBIWXMAABibAAAYmwFJdYOUAAABe0lEQVR42k2SPW/UQBCG79dR8hNSItFTp4goKKgoqRASXRQRPiT+AMoVUKSJSe4Sgs6xc8557bX32x8P8jqHeKXZeUc7mpmddxfjODLh0bG6l0jtGIeergv0XUffT7z7zwJd8HQhxDh4H/MmLKajewyMtbw4/sXp+ZbBG0RrqRpF0zQYY9BaRzPWYfs5XxsbuTYO7xwL7+dOPgRU22DPPtCvv2OkQHx8ib7+gXZzwz3G7SXt6RGMA8gM9fUVQaQo61hM3ZMk4c8mZXOzonn3DPv5iDTLKI8PkW+eUmxu2ImKSpTIVrPbXLN7/YT65BAhW6q3BzTvn6OngiEELi4SiqKIT/m9/Mb28id+gO19Trb8hG4qxn/jDdE1d2v01Vnkt8k56fIL1tp5h3sopWhdh+tGKiFYrdZc3d5RPOziXV3XKKWjIL4fCdP+gyfNch5qFfe8mFTeKz1Na43G2VkAKSV1JdBKUZYleZ4jhMA5hzEaEwWyUWVnTPwNfwEyxg+/wyQg+AAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"AWS Static Content - ModSecurity.png\"\n        title=\"\"\n        src=\"/static/f749210300bc0c5cd0f4930b0586f413/fcda8/AWS%2BStatic%2BContent%2B-%2BModSecurity.png\"\n        srcset=\"/static/f749210300bc0c5cd0f4930b0586f413/12f09/AWS%2BStatic%2BContent%2B-%2BModSecurity.png 148w,\n/static/f749210300bc0c5cd0f4930b0586f413/e4a3f/AWS%2BStatic%2BContent%2B-%2BModSecurity.png 295w,\n/static/f749210300bc0c5cd0f4930b0586f413/fcda8/AWS%2BStatic%2BContent%2B-%2BModSecurity.png 590w,\n/static/f749210300bc0c5cd0f4930b0586f413/efc66/AWS%2BStatic%2BContent%2B-%2BModSecurity.png 885w,\n/static/f749210300bc0c5cd0f4930b0586f413/b12f7/AWS%2BStatic%2BContent%2B-%2BModSecurity.png 1020w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<p>CloudFront will be an important feature for the United States, but for the South America and Australia deployments, there are fewer edge locations (see <a href=\"http://aws.amazon.com/cloudfront/details/\">Amazon CloudFront Product Details</a> ) and will be less customer traffic.  An alternate solution to AWS WAF may be the best solution for now.</p>","frontmatter":{"title":"AWS WAF vs. ModSecurity","description":null,"date":"April 25, 2016","tags":["aws","waf","webdev","security"],"canonical":null}}},"pageContext":{"slug":"/2016-04-25-aws-waf-vs-modsecurity","previous":{"fields":{"slug":"/2016-03-28-graph-encryption-going-beyond-encrypted-keyword-search"},"frontmatter":{"tags":["search","encryption"]}},"next":{"fields":{"slug":"/2016-05-03-introduction-to-speech-interfaces-for-web-applications"},"frontmatter":{"tags":["webdev","vui","conference"]}}}},"staticQueryHashes":["2589769190","97908498"],"slicesMap":{}}