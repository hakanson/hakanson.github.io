{"componentChunkName":"component---src-templates-blog-post-js","path":"/2016-07-11-pokemon-go-vs-certificate-pinning","webpackCompilationHash":"f141a48750e2a6a883f2","result":{"data":{"site":{"siteMetadata":{"title":"kevinhakanson.com","author":"Kevin Hakanson"}},"markdownRemark":{"id":"8949182b-ddda-5fe6-ba91-3786d3ed95a7","excerpt":"Saw this Tweet from @notdan about the Pokémon Go video game and their lack of certificate pinning:  At first, I thought “duh, of course, they should have” but…","html":"<p>Saw this Tweet from <a href=\"https://twitter.com/notdan\">@notdan</a> about the <a href=\"http://www.pokemon.com/us/pokemon-video-games/pokemon-go/\">Pokémon Go</a> video game and their lack of certificate pinning:</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 576px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/75420e960ee1f202ea382dc034510785/9b31d/pastedImage_9.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 30.03472222222222%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAYAAADDl76dAAAACXBIWXMAAAsSAAALEgHS3X78AAABDElEQVQY06VOO0vEQBjMH5Zr7cUHVlZeY2GlYG+tbQpBzeViXnd5bB7rkexedsN54mX8soJ2IjgwMHzzMTPW7c0VpqeHWPEa8WIJpRRGDMPwK3fEXiucPSjs3XWY3Csc2QrW9cU5TvYnYFkK14+g+x5/xft2i8tZjwNb49juMH2kQClaiGYFIaUJ01pDCIGOlrat+LmNvu4h5dpoZfwWHxuN3Zv+LrHKqobjzhFGEZZJQtrFk+OQTvHszLBYJmCsMHr0X/wA7tz7ouchiGJ4dFt3ChtaTIEVhcUoyhJ+GCJnzIRx/orRS7McTdOgouIszw1rzs3fOKauOVhRmj9Jy60kTanBhx+Epv2/+ASFML7UDYQJUQAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"@notdan Pokemon Go Tweet\"\n        title=\"@notdan Pokemon Go Tweet\"\n        src=\"/static/75420e960ee1f202ea382dc034510785/9b31d/pastedImage_9.png\"\n        srcset=\"/static/75420e960ee1f202ea382dc034510785/cf440/pastedImage_9.png 148w,\n/static/75420e960ee1f202ea382dc034510785/d2d38/pastedImage_9.png 295w,\n/static/75420e960ee1f202ea382dc034510785/9b31d/pastedImage_9.png 576w\"\n        sizes=\"(max-width: 576px) 100vw, 576px\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<p>At first, I thought “duh, of course, they should have” but then I realized that I need to understand <a href=\"https://www.owasp.org/index.php/Certificate_and_Public_Key_Pinning\">Certificate and Public Key Pinning</a> better.  I’ve known about <a href=\"https://tools.ietf.org/html/rfc7469\">RFC 7469 - Public Key Pinning Extension for HTTP</a> and the HPKP header for a while, but never implemented it for any web applications (where the browser does the check) nor for any mobile/desktop applications (where you need to code the check yourself).</p>\n<p>I read though <a href=\"https://scotthelme.co.uk/hpkp-http-public-key-pinning/\">HPKP: HTTP Public Key Pinning</a> to see how these pins work.  I grabbed the <code class=\"language-text\">Public-Key-Pins</code> header from that blog post using a curl command:</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">$ <span class=\"token function\">curl</span> -sI <span class=\"token string\">\"https://scotthelme.co.uk/hpkp-http-public-key-pinning/\"</span> <span class=\"token operator\">|</span> <span class=\"token function\">grep</span> -Fi public-key-pins\n\nPublic-Key-Pins: pin-sha256<span class=\"token operator\">=</span><span class=\"token string\">\"X3pGTSOuJeEVw989IJ/cEtXUEmy52zs1TZQrU06KUKg=\"</span><span class=\"token punctuation\">;</span> pin-sha256<span class=\"token operator\">=</span><span class=\"token string\">\"MHJYVThihUrJcxW6wcqyOISTXIsInsdj3xK8QrZbHec=\"</span><span class=\"token punctuation\">;</span> pin-sha256<span class=\"token operator\">=</span><span class=\"token string\">\"isi41AizREkLvvft0IRW4u3XMFR2Yg7bvrF7padyCJg=\"</span><span class=\"token punctuation\">;</span> pin-sha256<span class=\"token operator\">=</span><span class=\"token string\">\"I/bAACUzdYEFNw2ZKRaypOyYvvOtqBzg21g9a5WVClg=\"</span><span class=\"token punctuation\">;</span> pin-sha256<span class=\"token operator\">=</span><span class=\"token string\">\"Y4/Gxyck5JLLnC/zWHtSHfNljuMbOJi6dRQuRJTgYdo=\"</span><span class=\"token punctuation\">;</span> pin-sha256<span class=\"token operator\">=</span><span class=\"token string\">\"/oCVQg3nP3DroGpFdAbaiYzenycUftqrH3LAyaIal2g=\"</span><span class=\"token punctuation\">;</span> pin-sha256<span class=\"token operator\">=</span><span class=\"token string\">\"0PiItvsnLZy1slbsVPGky8YnDsJavMNtxD0TPwsCdC8=\"</span><span class=\"token punctuation\">;</span> pin-sha256<span class=\"token operator\">=</span><span class=\"token string\">\"t3EPvqF+7XoKypCPHyN1b5uey7zTfIGDHn4oBWz2pds=\"</span><span class=\"token punctuation\">;</span> pin-sha256<span class=\"token operator\">=</span><span class=\"token string\">\"zqbcEslrpiH0bA9uhNyl2ovpLEfGJQM/QvZSVumMFJ8=\"</span><span class=\"token punctuation\">;</span> pin-sha256<span class=\"token operator\">=</span><span class=\"token string\">\"V+J+7lHvE6X0pqGKVqLtxuvk+0f+xowyr3obtq8tbSw=\"</span><span class=\"token punctuation\">;</span> pin-sha256<span class=\"token operator\">=</span><span class=\"token string\">\"Myokb3mG16eRkVBE+ZmFSKSpYQzWHKMY1MZbXgA8BkQ=\"</span><span class=\"token punctuation\">;</span> pin-sha256<span class=\"token operator\">=</span><span class=\"token string\">\"WSg/oQliyMYyP6yZ0CzDdQ8PHmtUkoUsOsa5svxxXxo=\"</span><span class=\"token punctuation\">;</span> pin-sha256<span class=\"token operator\">=</span><span class=\"token string\">\"9lBW+k9EF6yyG9413/fPiHhQy5Ok4UI5sBpBTuOaa/U=\"</span><span class=\"token punctuation\">;</span> pin-sha256<span class=\"token operator\">=</span><span class=\"token string\">\"ipMu2Xu72A086/35thucbjLfrPaSjuw4HIjSWsxqkb8=\"</span><span class=\"token punctuation\">;</span> pin-sha256<span class=\"token operator\">=</span><span class=\"token string\">\"6OnjvIKf0SxyerXzg9N0RvQ2sgaL6niV+MLn9wBrh+s=\"</span><span class=\"token punctuation\">;</span> pin-sha256<span class=\"token operator\">=</span><span class=\"token string\">\"9dNiZZueNZmyaf3pTkXxDgOzLkjKvI+Nza0ACF5IDwg=\"</span><span class=\"token punctuation\">;</span> max-age<span class=\"token operator\">=</span><span class=\"token number\">2592000</span><span class=\"token punctuation\">;</span> includeSubDomains<span class=\"token punctuation\">;</span> report-uri<span class=\"token operator\">=</span><span class=\"token string\">\"https://scotthelme.report-uri.io/r/default/hpkp/enforce\"</span></code></pre></div>\n<p>I generated the same value as one of the pins (thanks to the example from <a href=\"https://developer.mozilla.org/en-US/docs/Web/Security/Public_Key_Pinning\">Public Key Pinning - Web security | MDN</a> ):</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">$ openssl s_client -servername scotthelme.co.uk -connect scotthelme.co.uk:443 <span class=\"token punctuation\">\\</span>\n<span class=\"token operator\">|</span> openssl x509 -pubkey -noout <span class=\"token punctuation\">\\</span>\n<span class=\"token operator\">|</span> openssl rsa -pubin -outform der <span class=\"token punctuation\">\\</span>\n<span class=\"token operator\">|</span> openssl dgst -sha256 -binary <span class=\"token punctuation\">\\</span>\n<span class=\"token operator\">|</span> openssl enc -base64\n<span class=\"token assign-left variable\">depth</span><span class=\"token operator\">=</span><span class=\"token number\">1</span> /C<span class=\"token operator\">=</span>US/O<span class=\"token operator\">=</span>Let<span class=\"token string\">'s Encrypt/CN=Let'</span>s Encrypt Authority X3\nverify error:num<span class=\"token operator\">=</span><span class=\"token number\">20</span>:unable to get <span class=\"token builtin class-name\">local</span> issuer certificate\nverify return:0\nwriting RSA key\nX3pGTSOuJeEVw989IJ/cEtXUEmy52zs1TZQrU06KUKg<span class=\"token operator\">=</span></code></pre></div>\n<p>Now that I’ve leveled up my InfoSec skills, maybe I should go learn more about Pokemon?</p>\n<p><strong>Update</strong>: I was a little scared to login with my Google Account and give the app “Full Account Access” (see <a href=\"http://arstechnica.com/gaming/2016/07/pokemon-go-on-ios-gets-full-access-to-your-google-account/\">iOS version of Pokémon Go is a possible privacy trainwreck | Ars Technica</a> ) but after reading\n<a href=\"https://www.theguardian.com/technology/2016/jul/11/pokemon-go-privacy-security-full-access-google-account\">Have you given Pokémon Go full access to everything in your Google account? | Technology | The Guardian</a>  things might not be that bad.</p>","frontmatter":{"title":"Pokemon Go vs. Certificate Pinning","date":"July 11, 2016","tags":["http","security","pokemon"]}}},"pageContext":{"isCreatedByStatefulCreatePages":false,"slug":"/2016-07-11-pokemon-go-vs-certificate-pinning","previous":{"fields":{"slug":"/2016-06-10-zipkin-js-investigation"},"frontmatter":{"tags":["javascript","api","monitoring"]}},"next":{"fields":{"slug":"/2016-07-20-categorizing-information-security-topics"},"frontmatter":{"tags":["security"]}}}}}