{"componentChunkName":"component---src-templates-blog-post-js","path":"/2017-04-19-aws-stsassumerole-and-condition-keys","result":{"data":{"site":{"siteMetadata":{"title":"kevinhakanson.com","author":"Kevin Hakanson"}},"markdownRemark":{"id":"9d6dcd49-5773-5a3e-9fc2-4f2011bb5a60","excerpt":"In wondering how to restrict roles to only allowed to be assumed from specific EC2 instances, I found Actions and Condition Context Keys for AWS Security Token…","html":"<p>In wondering how to restrict roles to only allowed to be assumed from specific EC2 instances, I found <a href=\"http://docs.aws.amazon.com/IAM/latest/UserGuide/list_sts.html\">Actions and Condition Context Keys for AWS Security Token Service - AWS Identity and Access Management</a>, which lists the <code class=\"language-text\">Action</code> key that is used to assume role:</p>\n<ul>\n<li><a href=\"http://docs.aws.amazon.com/STS/latest/APIReference/API_AssumeRole.html\">sts:AssumeRole</a></li>\n</ul>\n<p>Here is an example of a trust policy:</p>\n<div class=\"gatsby-highlight\" data-language=\"json\"><pre class=\"language-json\"><code class=\"language-json\"><span class=\"token punctuation\">{</span>\n  <span class=\"token property\">\"Version\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"2012-10-17\"</span><span class=\"token punctuation\">,</span>\n  <span class=\"token property\">\"Statement\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>\n    <span class=\"token punctuation\">{</span>\n      <span class=\"token property\">\"Effect\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"Allow\"</span><span class=\"token punctuation\">,</span>\n      <span class=\"token property\">\"Principal\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token property\">\"Service\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"ec2.amazonaws.com\"</span>\n      <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n      <span class=\"token property\">\"Action\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"sts:AssumeRole\"</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">]</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>It doesn’t look like any <code class=\"language-text\">Condition</code> keys can be applied here based on:</p>\n<blockquote>\n<p><strong>Condition context keys for AWS Security Token Service</strong></p>\n<p>AWS Security Token Service has no service-specific context keys that can be used in an IAM policy. For the list of the global condition context keys that are available to all services, see <a href=\"http://docs.aws.amazon.com/IAM/latest/UserGuide/reference_policies_condition-keys.html#AvailableKeys\">Available Global Condition Keys</a> in the <em>IAM Policy Elements Reference</em>.</p>\n</blockquote>\n<p>Maybe some of these Global Condition Keys could be used?</p>\n<ul>\n<li><strong>aws:SourceArn</strong></li>\n<li><strong>aws:userid</strong></li>\n</ul>","frontmatter":{"title":"AWS sts:AssumeRole and Condition Keys","description":null,"date":"April 19, 2017","tags":["aws","iam"],"canonical":null}}},"pageContext":{"slug":"/2017-04-19-aws-stsassumerole-and-condition-keys","previous":{"fields":{"slug":"/2017-04-14-amazons3encryptionclient-example"},"frontmatter":{"tags":["aws","java","sdk","encryption"]}},"next":{"fields":{"slug":"/2017-04-25-aws-identity-based-resource-based-resource-level-and-tag-based-permissions"},"frontmatter":{"tags":["aws","iam"]}}}},"staticQueryHashes":["2589769190","3567236516"]}