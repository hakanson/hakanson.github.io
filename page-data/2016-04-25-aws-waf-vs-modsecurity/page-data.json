{"componentChunkName":"component---src-templates-blog-post-js","path":"/2016-04-25-aws-waf-vs-modsecurity","result":{"data":{"site":{"siteMetadata":{"title":"kevinhakanson.com","author":"Kevin Hakanson"}},"markdownRemark":{"id":"d9e68779-43f5-50dc-9249-cf6ae28671ec","excerpt":"In a recent meeting with the corporate security team, it was mentioned that a Web Application Firewall (WAF) might be the recommendation for cloud projects to…","html":"<p>In a recent meeting with the corporate security team, it was mentioned that a Web Application Firewall (WAF) might be the recommendation for cloud projects to protect against XSS and SQL Injection.  The Cloud Security Workstream has done some research, including WAF options.  As I dug into what an AWS WAF solution might look like, I came up with this diagram:</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/7157823f3bdb46f3be99ca89a554e0d7/1cfc2/AWS%2BStatic%2BContent%2B-%2BAWS%2BWAF.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 62.16216216216216%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAYAAABiDJ37AAAACXBIWXMAABibAAAYmwFJdYOUAAACPklEQVQoz51T24rTUBTtV/gFPvknfoD4rvgBPgjiiwgjDj6oyIAPggyKoAgieEUdRcc+dChGbGfaTi8xTdLc01xPLpN0uU9qL6K+GNjhnOxz9lp7rZ3abDbDIqqnYJhNe/jfp7ZazlDQm4kfgJ3TSMwDhHGOIPARhQFkVced9z20RQ2WoWOiadBNG5quQ9MmcF0XRVGgxpmlaYo8z5FlOXzPAtM6YK6BrCgrqCQO0RrIOH+/gZe7AlgcwbJtuPIArmPDdqdQVZXAA9SyLKsKZhQsSTEeDvFlcwPft27AIyb50REcupymGdB8ALzeACKzAgrunQF7e7NaG4YB3/dRY4zhqyCg1WrDcly09hpoXrmI3q1NjNotKJMJZFmuwn12FeH2OQQjAXbA4NQfw7x0Aln3E3THp+6m85b7/T4kaVy1bdkO9uu7GDT3EEYxwjCcM8wL2KM2up+fL1WP0xyq8BFF5JKe1pzhukNcVIWYHEoKDoYi6eMgIxDeDjcn5W2SrCYBqIpSAeVc4yxftbw+Mpwh/+hLHQTKYaXfQh9GGkvvXkG4fR0uuerROW5CQpJxH/ja87w5w0VBnuBo3a2zGG5fWLVGl1R5jMapk3h4/BgmO2/+mL8oiv5SME1AXqLz4i6M+pNf41mCG5cQmPj0Eb5duwxmGijpTlmWVVSO/4shN0FRVDJJWv5BfKwcGlzL82FPPZik7ZDGi7Pi5xfF+P63ghyNJ3kiooPhWnATfogi5PG42sdxvMwtCnNTfwJUB4Jivd+GiwAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"AWS Static Content - AWS WAF.png\"\n        title=\"AWS Static Content - AWS WAF.png\"\n        src=\"/static/7157823f3bdb46f3be99ca89a554e0d7/fcda8/AWS%2BStatic%2BContent%2B-%2BAWS%2BWAF.png\"\n        srcset=\"/static/7157823f3bdb46f3be99ca89a554e0d7/12f09/AWS%2BStatic%2BContent%2B-%2BAWS%2BWAF.png 148w,\n/static/7157823f3bdb46f3be99ca89a554e0d7/e4a3f/AWS%2BStatic%2BContent%2B-%2BAWS%2BWAF.png 295w,\n/static/7157823f3bdb46f3be99ca89a554e0d7/fcda8/AWS%2BStatic%2BContent%2B-%2BAWS%2BWAF.png 590w,\n/static/7157823f3bdb46f3be99ca89a554e0d7/efc66/AWS%2BStatic%2BContent%2B-%2BAWS%2BWAF.png 885w,\n/static/7157823f3bdb46f3be99ca89a554e0d7/1cfc2/AWS%2BStatic%2BContent%2B-%2BAWS%2BWAF.png 900w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<p>Since <a href=\"https://aws.amazon.com/waf/\">AWS WAF</a> and its <a href=\"http://docs.aws.amazon.com/waf/latest/developerguide/web-acl.html\">Web ACL</a> rules are a feature of the <a href=\"https://aws.amazon.com/cloudfront/\">Amazon CloudFront CDN</a>, a full solution would pull in other Amazon functionality.  CloudFront is most useful as a CDN, if you host your static content assets in S3.  You can configure both an S3 Origin for your static content and a Custom Origin for your dynamic content.  In the diagram above, a “behavior” with the “path prefix” of <code class=\"language-text\">api/*</code> was used to route application requests to the ELB.</p>\n<p>However, this solution requires some DNS changes.  CloudFront will now be configured for application hostname, and the ELB needs a new hostname.  This is where things become interesting.  In the classic <code class=\"language-text\">www.example.com</code> scenario, you make CloudFront respond to <code class=\"language-text\">www.example.com</code>, and your original ELB becomes something like <code class=\"language-text\">origin-www.example.com</code>, reflecting the fact it is the “Origin” server.  Our products use “naked” domains meaning <code class=\"language-text\">example.com</code> is the hostname instead of the more traditional <code class=\"language-text\">www.example.com</code>.  This makes the naming of <code class=\"language-text\">origin.example.com</code> harder (since <code class=\"language-text\">origin-example.com</code> would be a new domain).  It also may require us to use Route 53 for DNS because the requirement for an ALIAS record for the zone apex (see <a href=\"http://docs.aws.amazon.com/Route53/latest/DeveloperGuide/resource-record-sets-choosing-alias-non-alias.html\">Choosing Between Alias and Non-Alias Resource Record Sets - Amazon Route 53</a>).  This topic needs more investigation.</p>\n<p>Earlier, I investigated putting Apache HTTP in front of Zuul and use the ProxyPass directive to pass any <code class=\"language-text\">/api</code> URIs.  This was for HTTP/2 protocol support, but could also be used if we use the <a href=\"https://www.modsecurity.org/\">ModSecurity</a> Apache module as a WAF.  This solution means no new hostnames, less new infrastructure and could also be used by the deployments in the corporate data center until they can move to AWS.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/f749210300bc0c5cd0f4930b0586f413/b12f7/AWS%2BStatic%2BContent%2B-%2BModSecurity.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 35.13513513513513%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAYAAAAIy204AAAACXBIWXMAABibAAAYmwFJdYOUAAABgElEQVQoz1WRvW7UQBSF/Vg8BQ9AS0XBA6SmogxdRJWCJqQnioQCEggKioREEGnXKNGa7NrxT2zPnRl7bH/MeLUCjnTm3hndmTn33GiaJgJ2cVMJfe+YxpFxcIzj4DkyDMM/dAyu/7v3eagLiMISDgOUGJ4fXfPuKmPoNKV0VHVL0zSICEopzxYxHdpfmc+0nXMl2gvpicIy0zlU21B8OUbfXmLqgvLkFXK3QHeO/7C5Rs4Otnm1Qj6+ppcH/7ghquuaeLkkWack8U/M4VO6k5ckSUJ5+Izm4AnZ+jdlVVF7NmIp4u/kLx7RnO5T5RnV/mPa4z3EOiJjDOfnF6RpStsq4rMj0h9fMb6NdPWL9Yc3qLpi8D4GnwffyeiFPSy+oa7ezyJvLz6z/vQWY7uthzsETxrjsG6a1SyWMcvVhqIssdbOHoYYHu39DIPzox/IzeqO+1owRhOFX3cTDsVaFEZrr7alLAqK+2weSpZlsw15nhO6CnXiPxBf29ntPgz3Dy3bD9wREPrRAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"AWS Static Content - ModSecurity.png\"\n        title=\"AWS Static Content - ModSecurity.png\"\n        src=\"/static/f749210300bc0c5cd0f4930b0586f413/fcda8/AWS%2BStatic%2BContent%2B-%2BModSecurity.png\"\n        srcset=\"/static/f749210300bc0c5cd0f4930b0586f413/12f09/AWS%2BStatic%2BContent%2B-%2BModSecurity.png 148w,\n/static/f749210300bc0c5cd0f4930b0586f413/e4a3f/AWS%2BStatic%2BContent%2B-%2BModSecurity.png 295w,\n/static/f749210300bc0c5cd0f4930b0586f413/fcda8/AWS%2BStatic%2BContent%2B-%2BModSecurity.png 590w,\n/static/f749210300bc0c5cd0f4930b0586f413/efc66/AWS%2BStatic%2BContent%2B-%2BModSecurity.png 885w,\n/static/f749210300bc0c5cd0f4930b0586f413/b12f7/AWS%2BStatic%2BContent%2B-%2BModSecurity.png 1020w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<p>CloudFront will be an important feature for the United States, but for the South America and Australia deployments, there are fewer edge locations (see <a href=\"http://aws.amazon.com/cloudfront/details/\">Amazon CloudFront Product Details</a> ) and will be less customer traffic.  An alternate solution to AWS WAF may be the best solution for now.</p>","frontmatter":{"title":"AWS WAF vs. ModSecurity","description":null,"date":"April 25, 2016","tags":["aws","waf","webdev","security"],"canonical":null}}},"pageContext":{"slug":"/2016-04-25-aws-waf-vs-modsecurity","previous":{"fields":{"slug":"/2016-03-28-graph-encryption-going-beyond-encrypted-keyword-search"},"frontmatter":{"tags":["search","encryption"]}},"next":{"fields":{"slug":"/2016-05-03-introduction-to-speech-interfaces-for-web-applications"},"frontmatter":{"tags":["webdev","vui","conference"]}}}},"staticQueryHashes":["2589769190","3567236516"]}