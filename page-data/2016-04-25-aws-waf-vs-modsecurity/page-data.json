{"componentChunkName":"component---src-templates-blog-post-js","path":"/2016-04-25-aws-waf-vs-modsecurity","result":{"data":{"site":{"siteMetadata":{"title":"kevinhakanson.com","author":"Kevin Hakanson"}},"markdownRemark":{"id":"d9e68779-43f5-50dc-9249-cf6ae28671ec","excerpt":"In a recent meeting with the corporate security team, it was mentioned that a Web Application Firewall (WAF) might be the recommendation for cloud projects to…","html":"<p>In a recent meeting with the corporate security team, it was mentioned that a Web Application Firewall (WAF) might be the recommendation for cloud projects to protect against XSS and SQL Injection.  The Cloud Security Workstream has done some research, including WAF options.  As I dug into what an AWS WAF solution might look like, I came up with this diagram:</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 590px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/7157823f3bdb46f3be99ca89a554e0d7/6ed10/AWS%2BStatic%2BContent%2B-%2BAWS%2BWAF.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 62.22222222222222%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAYAAABiDJ37AAAACXBIWXMAABibAAAYmwFJdYOUAAACSklEQVQoz51Ty27TQBT1V/AHLPgcxB4JsWGFBIhNF0iskGDHY9NWlC4qAQsEAgmViqKqQvQllSp9JKRpGidOYs84tsdxxuPEPtwZkhCprBjp2iPP3HPvPefYKooCkzCryFFIhv9d1t9tgZye0v4OfLkG6ZYQDzLEsUC/3wfjPt7vnuPMYQh8DsY4uN8D58xEFEXI8xyW7izLMgyHQ6hsiMhvY8R+QsUe1Kgwl2TSx0GljhuLO3i7UYIIA7TbHXjtFjwC7nRdOE4LQghYGkymKZRS5t1uOvjx7ClK8y8QMReaiDDoQaohsP8O2eoTGiMwMyWv7yDdfGn2rusiDENYUkocHR+jUqmA0QiHu9vYeXAfJ48f4uxgHy3qpNm0KVqIPj6CXL4J8WsLXEjwrwvgc1egTtbh9oQpbOU08uHhkQFMqUOXMRytr+F08xsiGkFz43OOJM3Ayrsof15GPhr96VAq2BtvMOQ25fkEGMyKAsOX4zgo1xsoVWvwfd9Q4XkeYgJP9fiE5VOi57kIej0o+qa5dt2uKW7NWkbzGQQhIrcJQZGmasrPQPO7t42TlSXwbpdUZgZwQILJwcAIEkw6nAAqLZDKUF28jdOlexg709im02lj7/pVrFy+hNbqpwv+S5LkH4CpNCOUPzxHd21hwgO0cAl1UX01j627txA36lOKJrlxHF8EzIgvXanZOEe9Vp1W12JFkUBPxGRiThyGOKvVzF3dvQbT/BkfzgKOSD1zoC/QoRiHTrBt24A0Gg1E5Dcxcy7GbtA/x29QoIJdQva/ZgAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"AWS Static Content - AWS WAF.png\"\n        title=\"AWS Static Content - AWS WAF.png\"\n        src=\"/static/7157823f3bdb46f3be99ca89a554e0d7/799d3/AWS%2BStatic%2BContent%2B-%2BAWS%2BWAF.png\"\n        srcset=\"/static/7157823f3bdb46f3be99ca89a554e0d7/00d96/AWS%2BStatic%2BContent%2B-%2BAWS%2BWAF.png 148w,\n/static/7157823f3bdb46f3be99ca89a554e0d7/0b23c/AWS%2BStatic%2BContent%2B-%2BAWS%2BWAF.png 295w,\n/static/7157823f3bdb46f3be99ca89a554e0d7/799d3/AWS%2BStatic%2BContent%2B-%2BAWS%2BWAF.png 590w,\n/static/7157823f3bdb46f3be99ca89a554e0d7/2a3d6/AWS%2BStatic%2BContent%2B-%2BAWS%2BWAF.png 885w,\n/static/7157823f3bdb46f3be99ca89a554e0d7/6ed10/AWS%2BStatic%2BContent%2B-%2BAWS%2BWAF.png 900w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<p>Since <a href=\"https://aws.amazon.com/waf/\">AWS WAF</a> and its <a href=\"http://docs.aws.amazon.com/waf/latest/developerguide/web-acl.html\">Web ACL</a> rules are a feature of the <a href=\"https://aws.amazon.com/cloudfront/\">Amazon CloudFront CDN</a>, a full solution would pull in other Amazon functionality.  CloudFront is most useful as a CDN, if you host your static content assets in S3.  You can configure both an S3 Origin for your static content and a Custom Origin for your dynamic content.  In the diagram above, a “behavior” with the “path prefix” of <code class=\"language-text\">api/*</code> was used to route application requests to the ELB.</p>\n<p>However, this solution requires some DNS changes.  CloudFront will now be configured for application hostname, and the ELB needs a new hostname.  This is where things become interesting.  In the classic <code class=\"language-text\">www.example.com</code> scenario, you make CloudFront respond to <code class=\"language-text\">www.example.com</code>, and your original ELB becomes something like <code class=\"language-text\">origin-www.example.com</code>, reflecting the fact it is the “Origin” server.  Our products use “naked” domains meaning <code class=\"language-text\">example.com</code> is the hostname instead of the more traditional <code class=\"language-text\">www.example.com</code>.  This makes the naming of <code class=\"language-text\">origin.example.com</code> harder (since <code class=\"language-text\">origin-example.com</code> would be a new domain).  It also may require us to use Route 53 for DNS because the requirement for an ALIAS record for the zone apex (see <a href=\"http://docs.aws.amazon.com/Route53/latest/DeveloperGuide/resource-record-sets-choosing-alias-non-alias.html\">Choosing Between Alias and Non-Alias Resource Record Sets - Amazon Route 53</a>).  This topic needs more investigation.</p>\n<p>Earlier, I investigated putting Apache HTTP in front of Zuul and use the ProxyPass directive to pass any <code class=\"language-text\">/api</code> URIs.  This was for HTTP/2 protocol support, but could also be used if we use the <a href=\"https://www.modsecurity.org/\">ModSecurity</a> Apache module as a WAF.  This solution means no new hostnames, less new infrastructure and could also be used by the deployments in the corporate data center until they can move to AWS.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 590px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/f749210300bc0c5cd0f4930b0586f413/b4a26/AWS%2BStatic%2BContent%2B-%2BModSecurity.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 35.29411764705882%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAYAAAAIy204AAAACXBIWXMAABibAAAYmwFJdYOUAAABf0lEQVQoz02SvW7UQBDH/W48QB4gD0BBmypFJEpS0NDQolSJQiiIkOgoAF2qUOTryIVTuDvH3Pnr9tNr+/xj1ybASH/PaL07O/ObjbquI9ijv19JlHV0m5a2aWjboJbGx4P+xLX7t+bjsC9YFD6NPxDMWsvO2zHvvv1i4wy5qiiEQog1WutBSqFthfVHtLG9Qqy8d84R1XXNoAalJHJ0iLsbYWRJfrqPnp6j3XD7X1vdoT68CH2BSFAfX1IXDz5pRSSEYDwe83O+YD69Rb55inv/nMUiJjvaRbzaYjn7QZaXlHnOWhnS2YR0/wnrkz2Kck3xeht58MxXWw0VXlxckiRJX/706ynJ1RnVBpZJTPz5GF1mbAbEPdsQitkN6urTwP36nPmXkx5Z9H8nWntetqFqOsqy4HYy4ft9zCpNMcYQugm+8UU4zy2AaP1AZosHlqXq/0Vhuo8TDlCtB19Z43nqPmmRZ0gpSX3SOPYYsqyvxPh9Rg9JnPNDMrp/Db8BktoPx79rE7sAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"AWS Static Content - ModSecurity.png\"\n        title=\"AWS Static Content - ModSecurity.png\"\n        src=\"/static/f749210300bc0c5cd0f4930b0586f413/799d3/AWS%2BStatic%2BContent%2B-%2BModSecurity.png\"\n        srcset=\"/static/f749210300bc0c5cd0f4930b0586f413/00d96/AWS%2BStatic%2BContent%2B-%2BModSecurity.png 148w,\n/static/f749210300bc0c5cd0f4930b0586f413/0b23c/AWS%2BStatic%2BContent%2B-%2BModSecurity.png 295w,\n/static/f749210300bc0c5cd0f4930b0586f413/799d3/AWS%2BStatic%2BContent%2B-%2BModSecurity.png 590w,\n/static/f749210300bc0c5cd0f4930b0586f413/2a3d6/AWS%2BStatic%2BContent%2B-%2BModSecurity.png 885w,\n/static/f749210300bc0c5cd0f4930b0586f413/b4a26/AWS%2BStatic%2BContent%2B-%2BModSecurity.png 1020w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<p>CloudFront will be an important feature for the United States, but for the South America and Australia deployments, there are fewer edge locations (see <a href=\"http://aws.amazon.com/cloudfront/details/\">Amazon CloudFront Product Details</a> ) and will be less customer traffic.  An alternate solution to AWS WAF may be the best solution for now.</p>","frontmatter":{"title":"AWS WAF vs. ModSecurity","date":"April 25, 2016","tags":["aws","waf","webdev","security"]}}},"pageContext":{"isCreatedByStatefulCreatePages":false,"slug":"/2016-04-25-aws-waf-vs-modsecurity","previous":{"fields":{"slug":"/2016-03-28-graph-encryption-going-beyond-encrypted-keyword-search"},"frontmatter":{"tags":["search","encryption"]}},"next":{"fields":{"slug":"/2016-05-03-introduction-to-speech-interfaces-for-web-applications"},"frontmatter":{"tags":["webdev","vui","conference"]}}}}}