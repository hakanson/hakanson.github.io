{"componentChunkName":"component---src-templates-blog-post-js","path":"/2018-07-05-first-thoughts-on-aws-cloud9","webpackCompilationHash":"af0e4c24d4a507da8bf9","result":{"data":{"site":{"siteMetadata":{"title":"kevinhakanson.com","author":"Kevin Hakanson"}},"markdownRemark":{"id":"c7d3b48c-f832-5ff0-9a5d-9c141463410b","excerpt":"The other week I had trouble creating an AWS Cloud9 environment, so I tried again today - and with success, because I actually met the requirements found at VPC…","html":"<p>The other week I had trouble creating an <a href=\"https://aws.amazon.com/cloud9/\">AWS Cloud9</a> environment, so I tried again today - and with success, because I actually met the requirements found at <a href=\"https://docs.aws.amazon.com/cloud9/latest/user-guide/vpc-settings.html\">VPC Settings for AWS Cloud9 Development Environments</a> and put the instance in a public subnet.  However, it created a Security Group with port 22 open to the internet - which I didn’t like…</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 590px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/4663d487b8153911103496908d6b4bc6/99d00/pastedImage_3.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 22.964169381107492%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAYAAABFA8wzAAAACXBIWXMAAAsSAAALEgHS3X78AAAAsElEQVQY051PSQ7DIBDj/79sG5YQIKxp1rowEj1VPXQkC2zskWEubfDlgI1P3MUEF1domzAoC6ln8NERlAmY5gJRtbReiMsBNYXq8aS10/gCJjiHlg/I4QYhBErJOM8Dv+b1ughfXsC897Rg37e6rGBZlspP/DtMSomcC2KMtNAYA6018Q6lFKHzVqLlQgjEU0qw1oLX31LD1qq3c86Rqd273jwt1LWcM8Zx/GS61nJvIlOCBOznWE0AAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"pastedImage 3\"\n        title=\"pastedImage 3\"\n        src=\"/static/4663d487b8153911103496908d6b4bc6/b9e4f/pastedImage_3.png\"\n        srcset=\"/static/4663d487b8153911103496908d6b4bc6/cf440/pastedImage_3.png 148w,\n/static/4663d487b8153911103496908d6b4bc6/d2d38/pastedImage_3.png 295w,\n/static/4663d487b8153911103496908d6b4bc6/b9e4f/pastedImage_3.png 590w,\n/static/4663d487b8153911103496908d6b4bc6/f9b6a/pastedImage_3.png 885w,\n/static/4663d487b8153911103496908d6b4bc6/2d849/pastedImage_3.png 1180w,\n/static/4663d487b8153911103496908d6b4bc6/99d00/pastedImage_3.png 1228w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<p>..and neither did an automated security process because within a minute it removed that rule - which was good for security, but bad for accessing the Cloud9 based environment.  However, there are instructions to limit to specific IPs.</p>\n<blockquote>\n<p>All IP addresses using SSH over port 22. However, you can restrict these IP addresses to only those that AWS Cloud9 uses. For more information, see <a href=\"https://docs.aws.amazon.com/cloud9/latest/user-guide/ip-ranges.html\">Inbound SSH IP Address Ranges</a>.</p>\n</blockquote>\n<p>I did that, and within seconds of saving, I was able to connect to my Cloud9 environment from the browser.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 590px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/f5f1777a0001ecf7d99fc69879f0563f/a666d/pastedImage_4.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 25.816733067729082%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAYAAABFA8wzAAAACXBIWXMAAAsSAAALEgHS3X78AAAAxklEQVQY032P63KEIAxGff+3rGtVYJX7RQW+Ejp1pz92mTkTTgghDEInKH/ChAy+GbCGtAkLl2BPjUUorEJCSAexW2w6IBzApnw//2M3ES4VDE8h8D09wJcRj/ELovmREj6v+jY/KKVgjEUtGdd5IrZmRM755rquf/6ivGoapZTfhoxzaK1Beykl5nnukZwgZ4zdvq5rd6qhe/SrcRyx7TsG7x1Sm4i6E8dxwDuHWmt3mi7GeE9CeWNMfySE0D9KcZomWGvxA0zUgk91n9u7AAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"pastedImage 4\"\n        title=\"pastedImage 4\"\n        src=\"/static/f5f1777a0001ecf7d99fc69879f0563f/b9e4f/pastedImage_4.png\"\n        srcset=\"/static/f5f1777a0001ecf7d99fc69879f0563f/cf440/pastedImage_4.png 148w,\n/static/f5f1777a0001ecf7d99fc69879f0563f/d2d38/pastedImage_4.png 295w,\n/static/f5f1777a0001ecf7d99fc69879f0563f/b9e4f/pastedImage_4.png 590w,\n/static/f5f1777a0001ecf7d99fc69879f0563f/f9b6a/pastedImage_4.png 885w,\n/static/f5f1777a0001ecf7d99fc69879f0563f/2d849/pastedImage_4.png 1180w,\n/static/f5f1777a0001ecf7d99fc69879f0563f/a666d/pastedImage_4.png 1255w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<p>I opened the Terminal window and tested what sort of AWS access I had.  The environment runs with my Federated Identity credentials.</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">$ aws sts get-caller-identity\n<span class=\"token punctuation\">{</span>\n    <span class=\"token string\">\"Account\"</span><span class=\"token builtin class-name\">:</span> <span class=\"token string\">\"123456789012\"</span>, \n    <span class=\"token string\">\"UserId\"</span><span class=\"token builtin class-name\">:</span> <span class=\"token string\">\"AROAXXXXXXXXXXXXXXXXX:kevin.hakanson@example.com\"</span>, \n    <span class=\"token string\">\"Arn\"</span><span class=\"token builtin class-name\">:</span> <span class=\"token string\">\"arn:aws:sts::123456789012:assumed-role/projectID-PowerUser/kevin.hakanson@example.com\"</span>\n<span class=\"token punctuation\">}</span>\n\n$ aws --version\naws-cli/1.14.9 Python/2.7.14 Linux/4.14.47-56.37.amzn1.x86_64 botocore/1.8.13</code></pre></div>\n<p>The <a href=\"https://docs.aws.amazon.com/cloud9/latest/user-guide/ami-contents.html\">Amazon Machine Image (AMI) Contents for an AWS Cloud9 EC2 Development Environment</a> did not impress me as they had an outdated version of the awscli.  Also, I followed the <a href=\"https://docs.aws.amazon.com/cloud9/latest/user-guide/sample-python.html\">Python Sample for AWS Cloud9</a> which I think confused me even more because in one place it is using virtual environments  (<code class=\"language-text\">virtualenv -p /usr/bin/python36 vpy36</code>) and later running as sudo for the system Python (<code class=\"language-text\">sudo python -m pip install boto3</code>).  I did figure out how to create a custom “runner” that would use the virtualenv.</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">$ <span class=\"token function\">cat</span> .c9/runners/vpy36.run \n// Create a custom Cloud9 runner - similar to the Sublime build system\n// For <span class=\"token function\">more</span> information see http://docs.aws.amazon.com/console/cloud9/create-run-config\n<span class=\"token punctuation\">{</span>\n    <span class=\"token string\">\"cmd\"</span> <span class=\"token builtin class-name\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">\"/home/ec2-user/environment/vpy36/bin/python\"</span>, <span class=\"token string\">\"<span class=\"token variable\">$file</span>\"</span>, <span class=\"token string\">\"<span class=\"token variable\">$args</span>\"</span><span class=\"token punctuation\">]</span>,\n    <span class=\"token string\">\"info\"</span> <span class=\"token builtin class-name\">:</span> <span class=\"token string\">\"Started <span class=\"token variable\">$project_path</span><span class=\"token variable\">$file_name</span>\"</span>,\n    <span class=\"token string\">\"env\"</span> <span class=\"token builtin class-name\">:</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span>,\n    <span class=\"token string\">\"selector\"</span> <span class=\"token builtin class-name\">:</span> <span class=\"token string\">\"source.ext\"</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>Eventually I got some code to run, but I don’t think my Python environment is in a stable state - certainly not a “spin up and get coding” experience.</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">import</span> boto3\n<span class=\"token keyword\">import</span> sys\n<span class=\"token keyword\">import</span> json\n\n<span class=\"token keyword\">def</span> <span class=\"token function\">main</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    session <span class=\"token operator\">=</span> boto3<span class=\"token punctuation\">.</span>session<span class=\"token punctuation\">.</span>Session<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n    caller_identity <span class=\"token operator\">=</span> session<span class=\"token punctuation\">.</span>client<span class=\"token punctuation\">(</span><span class=\"token string\">'sts'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>get_caller_identity<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>json<span class=\"token punctuation\">.</span>dumps<span class=\"token punctuation\">(</span>caller_identity<span class=\"token punctuation\">,</span> indent<span class=\"token operator\">=</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token keyword\">if</span> __name__ <span class=\"token operator\">==</span> <span class=\"token string\">'__main__'</span><span class=\"token punctuation\">:</span>\n    sys<span class=\"token punctuation\">.</span>exit<span class=\"token punctuation\">(</span>main<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></code></pre></div>","frontmatter":{"title":"First Thoughts on AWS Cloud9","date":"July 05, 2018","tags":["aws","cloud9","python"]}}},"pageContext":{"isCreatedByStatefulCreatePages":false,"slug":"/2018-07-05-first-thoughts-on-aws-cloud9","previous":{"fields":{"slug":"/2018-06-27-selecting-an-elasticache-redis-auth-token"},"frontmatter":{"tags":["aws","secretsmanager","redis","security"]}},"next":{"fields":{"slug":"/2018-08-31-aws-waf-aws-shield-for-ddos-protection"},"frontmatter":{"tags":["aws","waf","security"]}}}}}